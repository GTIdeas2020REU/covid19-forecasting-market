{"version":3,"sources":["components/Navbar/index.js","constants/routes.js","utils/data.js","components/InteractiveChartTemp/index.js","components/ParentChart/index.js","containers/ChartContainer/index.js","pages/AboutPage/index.js","pages/LandingPage/index.js","components/LeaderboardChart/index.js","constants/colors.js","components/Leaderboard/index.js","components/UserPredictionChart/index.js","containers/UserPredictionChartContainer/index.js","pages/ProfilePage/index.js","components/InteractiveChart/index.js","containers/InteractiveChartContainer/index.js","components/Mapportal/index.js","components/LogIn/index.js","components/SignUp/index.js","App.js","serviceWorker.js","index.js","components/Navbar/COVIDforecasts-logo-white.png"],"names":["Navbar","props","changeTab","tabID","setState","console","log","state","active","isLoggedIn","fetch","then","response","json","data","loggedinstate","logoutbutton","loginbutton","signupbutton","bind","this","method","headers","window","location","href","className","id","data-toggle","exact","activeClassName","to","onClick","saveLogout","src","covidforecastslogo","style","width","marginTop","type","data-target","aria-controls","aria-expanded","aria-label","renderDropdown","React","Component","organizeData","orgs","Object","keys","results","i","length","forecast","dates","target_end_date","values","value","result","forEach","key","push","clamp","a","b","c","Math","max","min","getMostRecentPrediction","sort","Date","reformatData","map","date","d3","reformatPredData","d","substring","defined","findYatX","x","path","startX","getXY","len","point","getPointAtLength","y","start","end","getTotalLength","mid","currPoint","currPointX","getAllDataPoints","pathNode","xAxis","yAxis","startDate","endDate","invert","offset","getDataPointsFromPath","predictionData","lastPredDate","cleanData","predStartDate","idxOfStartDate","f","left","splice","getLastValue","getLastDate","createDefaultPrediction","predEndDate","defaultData","currDate","InteractiveChartTemp","modal","document","createElement","modalContent","text","innerText","signinBtn","onclick","signupBtn","appendChild","querySelector","append","chart","renderChart","userPrediction","confirmed","confirmedAvg","aggregate","loggedIn","height","marginBottom","appendModal","domain","svg","confirmedData","confirmedTemp","confirmedLastVal","aggregateData","forecastData","line","curve","predLine","labels","concat","color","range","confirmedBoundary","defs","confirmedArea","attr","predictionArea","datum","selectAll","enter","index","filter","cleanPrediction","filteredData","predictionLine","forecastPaths","querySelectorAll","confirmedPath","aggregatePath","compiledData","drag","on","pos","round","node","category","body","JSON","stringify","call","getElementById","event","target","display","focus","focusX","focusY","focusHeight","nice","brush","extent","selection","newX","select","gb","move","defaultSelection","focusLine","focusPredLine","createFocusContext","ParentChart","chartRef","createRef","confirmedStartdate","setUpChart","confirmedStartDate","isProfile","predLength","margin","current","yMax","currMax","ChartContainer","res","pstyle","textAlign","marginLeft","fontSize","paddingLeft","paddingRight","h1style","AboutPage","LeaderboardChart","prevProps","prevState","legendString","legend","mainArea","lineGenerator","predLineGenerator","today","toISOString","todayMarker","padding","ref","colors","Table","columns","forecasts","useTable","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","headerGroup","getHeaderGroupProps","column","render","getHeaderProps","RenderOrgsTable","RenderUsersTable","users","selectedID","user","mse_score","username","$","removeClass","addClass","empty","ReactDOM","prediction","createUserChart","toFixed","entries","backgroundColor","org","temp","createOrgChart","Leaderboard","Header","accesor","getCellValue","row","children","eq","click","undefined","asc","table","parents","find","toArray","valA","valB","isNumeric","toString","localeCompare","reverse","trigger","remove","overflowY","position","UserPredictionChart","userStatus","innerHTML","p","sortedDict","dateObj","sortDictByDate","sortedDates","sortStringDates","mostRecentPred","tooltip","mousePerLine","todayDate","newDate","pred","mouse","xCoord","element","floor","ceil","UserPredictionChartContainer","ProfilePage","renderUser","InteractiveChart","loginStatus","renderChartUnregistered","confirmedLastDate","mse","orgIndices","sortable","err","sortedOrgs","j","tempForecast","Array","k","w","h","confirmedMax","forecastMax","yAxisMax","models","o","names","modelClassNames","confirmedLine","confirmedAreaEndX","confirmedAreaEndY","yourLine","slice","getElementsByClassName","name","lastDate","m","getBoundingClientRect","drawingInstruction","selectCircle","focusPredCurve","tooltipArea","tooltipBox","yCoord","xLowerBoundary","pageX","pageY","textBox","html","filtered","legendCompleteWidth","legendConfirmed","legendAggregate","legendPrediction","legendGeorgiaTech","legendIhme","legendYouyang","legendColumbia","legendUcla","savePrediction","confirmedAreaWidth","clickAreaWidth","deletePrediction","class","InteractiveChartContainer","user_mse","mapStyle","feature","weight","opacity","dashArray","fillOpacity","fillColor","Mapportal","onEachFeature","layer","bindTooltip","properties","noHide","openTooltip","mouseover","highlightFeature","mouseout","resetHighlight","e","alert","setStyle","L","Browser","ie","opera","edge","bringToFront","geojson","resetStyle","countries","center","zoom","layers","tileLayer","maxZoom","attribution","geoJson","statesData","addTo","countriesData","overlay","control","layerGroup","Login","wasSucess","Promise","resolve","reject","updateLoginState","setTimeout","password","preventDefault","saveLogin","onSubmit","handleSubmit","onChange","handleChange","required","SignUp","nam","email","App","basename","component","Boolean","hostname","match","navigator","serviceWorker","ready","registration","unregister","catch","error","message","module","exports"],"mappings":"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","file":"static/js/main.58558aa6.chunk.js","sourcesContent":["import React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport * as ROUTES from '../../constants/routes';\nimport covidforecastslogo from './COVIDforecasts-logo-white.png'\nimport './Navbar.css'\n\nclass Navbar extends React.Component {\n  \tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = { \n\t\t\tloggedinstate: '', \n\t\t\tlogoutbutton: null, \n\t\t\tloginbutton: null, \n\t\t\tsignupbutton: null,\n\t\t}\n\t\tthis.isLoggedIn = this.isLoggedIn.bind(this)\n\t}\n\n\t/*\n\tisLoggedIn() {\n\t\tfetch('/user-status').then(res => res.json()).then(data => {\n\t\t\tthis.setState({ users: data });\n\t\t});\n\t}*/\n\n\tcomponentDidMount() {\n\t\tconsole.log(\"nav bar loading\");\n\t\tthis.isLoggedIn();\n\t\tthis.setState({'active': 'home'});\n\t}\n\n\tchangeTab = (tabID) => {\n\t\tthis.setState({'active': tabID});\n\t\tconsole.log(\"ACTIVE TAB\");\n\t\tconsole.log(this.state.active);\n\t}\n\n\tasync saveLogout() {\n\t\tfetch('/logout/',{\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t}\n\t\t});\n\t\twindow.location.href = '/'\n\t\t\n\t}\n\n\tisLoggedIn = () => {\n\t\tfetch('/login-status/')\n\t\t.then((response) => response.json())\n\t\t.then((data) => this.setState({loggedinstate: data}));\n\t}\n\n\n\trenderDropdown(){\n\t\tif (this.state.loggedinstate['logged in']) {\n\t\t\treturn (\n\t\t\t\t<div className='navbar-nav ml-auto dropleft'>\n\t\t\t\t\t<ul className=\"navbar-nav ml-auto\">\n\t\t\t\t\t\t<li className=\"nav-item dropdown ml-auto\">\n\t\t\t\t\t\t\t<a className=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbardrop\" data-toggle=\"dropdown\">\n\t\t\t\t\t\t\t\tHello {this.state.loggedinstate['name']}!\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<div className=\"dropdown-menu dropdown-menu-left\">\n\t\t\t\t\t\t\t<NavLink exact activeClassName=\"active\" className=\"dropdown-item\" to={ROUTES.PROFILE}>Profile</NavLink>\n\t\t\t\t\t\t\t<NavLink className=\"dropdown-item\" to={ROUTES.LANDING}><a className=\"dropdown-item\" onClick={() => this.saveLogout()} >Sign Out</a></NavLink>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\telse {\n\t\t\treturn (\n\t\t\t\t<div className='navbar-nav ml-auto dropleft'>\n\t\t\t\t\t<ul className=\"navbar-nav ml-auto\">\n\t\t\t\t\t\t<li className=\"nav-item dropdown\">\n\t\t\t\t\t\t\t<a className=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbardrop\" data-toggle=\"dropdown\">Sign In/Sign Up</a>\n\t\t\t\t\t\t\t<div className=\"dropdown-menu\">\n\t\t\t\t\t\t\t\t<NavLink exact activeClassName=\"active\" className=\"dropdown-item\" to={ROUTES.SIGN_UP}>Sign Up</NavLink>\n\t\t\t\t\t\t\t\t<NavLink exact activeClassName=\"active\" className=\"dropdown-item\" to={ROUTES.SIGN_IN}>Sign In</NavLink>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t}\n\n\n  \trender() {\n\t\treturn (\n\t\t\t<nav className=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n\t\t\t\t<a className=\"navbar-brand\" href='/'>\n\t\t\t\t\t<img id='logo' src={covidforecastslogo} style={{width:450, marginTop: -10}}></img>\n\t\t\t\t</a>\n\t\t\t\t<button className=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarNavAltMarkup\" aria-controls=\"navbarNavAltMarkup\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n\t\t\t\t\t<span className=\"navbar-toggler-icon\"></span>\n\t\t\t\t</button>\n\t\t\t\t<div className=\"collapse navbar-collapse\" id=\"navbarNavAltMarkup\">\n\t\t\t\t\t<div className=\"navbar-nav\">\n\t\t\t\t\t\t<NavLink exact activeClassName=\"active\" className=\"nav-item nav-link\" to={ROUTES.LANDING}>Home</NavLink>\n\t\t\t\t\t\t<NavLink exact activeClassName=\"active\" className=\"nav-item nav-link\" to={ROUTES.ABOUT}>About</NavLink>\n\t\t\t\t\t\t<NavLink exact activeClassName=\"active\" className=\"nav-item nav-link\" to={ROUTES.LEADERBOARD}>Top Forecasts</NavLink>\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t{this.renderDropdown()}\n\t\t\t\t</div>\n\t\t\t</nav>\n\t\t);\n  \t}\n}\n\nexport default Navbar;\n","export const LANDING = '/';\nexport const SIGN_UP = '/signup';\nexport const SIGN_IN = '/signin';\nexport const ABOUT = '/about';\nexport const PROFILE = '/profile';\nexport const MAP_PORTAL = '/map-portal';\nexport const MARKET = '/market';\nexport const LEADERBOARD = '/leaderboard';\nexport const US_NATIONAL_CUM = '/us-national-cumulative';\nexport const US_NATIONAL_INC = '/us-national-incident';\nexport const US_STATE = '/us-state';\n","import * as d3 from 'd3'\n\nexport const cleanConfirmedData = (data, dates) => {\n  var result = {};\n  for (var i = 0; i < dates.length; i++) {\n    result[dates[i]] = data[dates[i]];\n  }\n  return result;\n};\n\nexport const organizeData = (data) => {\n  var orgs = Object.keys(data);\n  var results = [];\n  for (var i = 0; i < orgs.length; i++) {\n    var forecast = data[orgs[i]];\n    var dates = forecast.target_end_date;\n    var values = forecast.value;\n\n    var result = {};\n    dates.forEach((key, i) => result[key] = values[i]);\n    results.push(result);\n  }\n\n  return [results, orgs];\n}\n\n\nfunction addDays(date, days) {\n  var result = new Date(date);\n  result.setDate(result.getDate() + days);\n  return result;\n}\n\n\nexport const getDates = () => {\n  var current = new Date(2020, 2, 28);\n  var end = new Date();\n  var dateArray = [];\n  while (current <= end) {\n      dateArray.push(new Date(current).toISOString().slice(0,10));\n      current = addDays(current, 1);\n  }\n  return dateArray;\n}\n\nexport const clamp = (a, b, c) => { \n  return Math.max(a, Math.min(b, c)) \n}\n\nexport const formatValue = (value) => {\n  return value.toLocaleString(\"en\", {\n    style: \"currency\",\n    currency: \"USD\"\n  });\n}\nexport const callout = (g, value) => {\n  if (!value) return g.style(\"display\", \"none\");\n\n  g\n      .style(\"display\", null)\n      .style(\"pointer-events\", \"none\")\n      .style(\"font\", \"10px sans-serif\");\n\n  const path = g.selectAll(\"path\")\n    .data([null])\n    .join(\"path\")\n      .attr(\"fill\", \"white\")\n      .attr(\"stroke\", \"black\");\n\n  const text = g.selectAll(\"text\")\n    .data([null])\n    .join(\"text\")\n    .call(text => text\n      .selectAll(\"tspan\")\n      .data((value + \"\").split(/\\n/))\n      .join(\"tspan\")\n        .attr(\"x\", 0)\n        .attr(\"y\", (d, i) => `${i * 1.1}em`)\n        .style(\"font-weight\", (_, i) => i ? null : \"bold\")\n        .text(d => d));\n\n  const {x, y, width: w, height: h} = text.node().getBBox();\n\n  text.attr(\"transform\", `translate(${-w / 2},${15 - y})`);\n  path.attr(\"d\", `M${-w / 2 - 10},5H-5l5,-5l5,5H${w / 2 + 10}v${h + 20}h-${w + 20}z`);\n}\n\nexport const sortDictByDate = (data) => {\n  var sortedDict = {};\n  const sortedDates = Object.keys(data).sort((a, b) => new Date(a) - new Date(b));\n  sortedDates.map(d => {\n    const dateObj = d3.timeParse(\"%Y-%m-%d\")(d);\n    sortedDict[dateObj] = data[d]\n  })\n  return sortedDict;\n}\n//pass in list of string dates, return string dates y-m-d\nexport const sortStringDates = (data) => {\n  var sortedDates = data.sort((a, b) => new Date(a) - new Date(b));\n  sortedDates = sortedDates.map(d => d3.timeParse(\"%Y-%m-%d\")(d));\n  return sortedDates;\n}\n\nexport const getMostRecentPrediction = (data) => {\n  if (Object.keys(data).length === 0) return null;\n  const sortedDates = Object.keys(data).sort((a, b) => new Date(b) - new Date(a));\n  const mostRecentDate = sortedDates[0];\n  return data[mostRecentDate]\n}\n\nexport const reformatData = (data) => {\n  return Object.keys(data).map(key => ({\n    date: d3.timeParse(\"%Y-%m-%d\")(key),\n    value: data[key]\n}));\n}\n\nexport const reformatPredData = (data) => {\n  return data.map(d => ({\n      date: d3.timeParse(\"%Y-%m-%d\")((d.date).substring(0,10)),\n      value: d.value,\n      defined: d.defined\n      })\n  );\n}\n//returns y coordinate at given x \n/*export const findYatX = (x, path) => {\n  if (x > path.getTotalLength()) {return null}\n  const getXY = (len) => {\n      var point = path.getPointAtLength(len);\n      return [point.x, point.y];\n  }\n  var start = 0;\n  var end = path.getTotalLength();\n  var result = 0;\n  while (start < end) { \n    var mid = (start + end) / 2;\n    var currPoint = getXY(mid);\n    var currPointX = currPoint[0];\n    if (x < currPointX) {\n      end = mid - 0.01; //does it have to be 0.01?\n    }\n    else if (x > currPointX) {\n      start = mid + 0.01;\n    }\n    else {\n      console.log(currPointX);\n      result = currPoint[1];\n      break;\n    }\n  }\n  if (result == 0) {\n    console.log(start, end);\n    return getXY(start)[1];\n  }\n  return result;\n}*/\n\nexport const findYatX = (x, path, startX) => {\n  const getXY = (len) => {\n      var point = path.getPointAtLength(len);\n      return [point.x, point.y, len];\n  }\n  var start = startX;\n  var end = path.getTotalLength();\n  var result = 0;\n  while (start < end) { \n    var mid = (start + end) / 2;\n    var currPoint = getXY(mid);\n    var currPointX = currPoint[0];\n    if (x < currPointX) {\n      end = mid - 0.001; //does it have to be 0.01?\n    }\n    else if (x > currPointX) {\n      start = mid + 0.001;\n    }\n    else {\n      result = currPoint;\n      break;\n    }\n  }\n  if (result === 0) {\n    result = getXY(start);\n  }\n  return result;\n}\n\n//for confirmedData, forecastData, aggregateData\nexport const getAllDataPoints = (pathNode, xAxis, yAxis, startDate, endDate) => {\n  var data = [];\n  var date = startDate;\n  var startX = 0;\n  while (+date <= +endDate) {\n    var x = xAxis(date);\n    var point = findYatX(x, pathNode, startX);\n    data.push({\n      date: date,\n      value: yAxis.invert(point[1])\n    });\n    startX = point[2];\n    date = d3.timeDay.offset(date, 1);\n  }\n  return data;\n}\nexport const getDataPointsFromPath = (predictionData, pathNode, xAxis, yAxis, lastPredDate) => {\n  var date = predictionData[0].date;\n  var startX = 0;\n  for (var i = 0; i < predictionData.length; i++) {\n    if (+predictionData[i].date > +lastPredDate) {\n      break;\n    }\n    if (predictionData[i].defined === 0) {\n      date = predictionData[i].date;\n      var point = findYatX(xAxis(date), pathNode, startX);\n      predictionData[i].defined = true;\n      predictionData[i].value = yAxis.invert(point[1]);\n      startX = point[2];\n    }\n  }\n  return predictionData;\n}\n\nexport const cleanData = (data, predStartDate, value) => {\n  var idxOfStartDate = d3.bisector(f => f.date).left(data, predStartDate);\n  if (data.length > 0 && +data[idxOfStartDate].date === +predStartDate) {\n    data[idxOfStartDate].value = value;\n  }\n  else {\n    data.splice(idxOfStartDate, 0, {\n        date: predStartDate,\n        value: value\n    });\n  } \n  return data.splice(idxOfStartDate, data.length);\n}\n\nexport const getLastValue = (data) => {\n  return data[data.length - 1].value;\n}\n\nexport const getLastDate = (data) => {\n  return data[data.length - 1].date;\n}\n\nexport const color = (names) => {\n  d3\n    .scaleOrdinal()\n    .domain(names)\n    .range(d3.schemeTableau10);\n}\n\nexport const createDefaultPrediction = (predStartDate, predEndDate) => {\n  var defaultData = [];\n  var currDate = predStartDate;\n  //var defined = true;\n  //var value = confirmedData[confirmedData.length - 1].value;\n  \n  //create defaultPredictionData\n  while(+currDate <= +predEndDate) {\n      defaultData.push({date: currDate, value: 0, defined: 0});\n      currDate = d3.timeDay.offset(currDate, 1);\n  }\n  return defaultData;\n}\n\nexport const cleanPrediction = (data, predStartDate, predEndDate, confirmedLastVal) => {\n  if (+data[0].date !== +predStartDate) {\n    console.log(\"needs to be reformatted\")\n    data = reformatPredData(data);\n    var currDate = d3.timeDay.offset(getLastDate(data), 1);\n    data = data.concat(createDefaultPrediction(currDate, predEndDate));\n  }\n  data = data.filter(d => (+d.date >= +predStartDate) && (+d.date <= +predEndDate));\n  data[0].value = confirmedLastVal;\n  data[0].defined = true;\n  return data;\n}\n\n\nexport const savePrediction = (data, category) => {\n  fetch('/update/',{\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\"data\": data, \"category\": category}),\n  });\n}\n\nexport const createFocusContext = (svg, width, height, marginBottom, confirmedData, aggregateData, forecastData, predictionData, labels, x, y, xAxis, line, predLine, color) => {\n  const focusHeight = 100;\n  const focusMargin = 50;\n  var focus = svg\n                  .append(\"g\")\n                      .attr(\"viewBox\", [0, 0, width, focusHeight])\n                      .attr(\"transform\", `translate(0,${height + focusMargin} )`)\n                      //.attr(\"width\", width + 100)\n                      //.attr(\"height\", height)\n                      .style(\"display\", \"block\")\n\n  var focusX = d3\n                  .scaleTime()\n                  .domain(x.domain())\n                  .range([0, width]);\n  const focusY = d3\n                  .scaleLinear()\n                  .domain(y.domain())\n                  .range([focusHeight - focusMargin, 0])\n                  .nice();\n  \n  var focusXAxis = focus\n                        .append(\"g\")\n                        .attr(\"transform\", `translate(0,${focusHeight - marginBottom})`)\n                        .call(d3.axisBottom(focusX));\n  const brush = d3.brushX()\n                  .extent([[0, 0], [width, focusHeight - marginBottom]])\n                  .on(\"brush\", brushed)\n                  .on(\"end\", brushended);\n\n  const defaultSelection = [x(d3.timeMonth.offset(x.domain()[1], -8)), x.range()[1]];\n\n  const focusLine = d3.line()\n                      .curve(d3.curveCatmullRom)\n                      .x(function(d) {return x(d.date)})\n                      .y(function (d) {return focusY(d.value)})\n  \n  const focusPredLine = d3.line()\n                          .curve(d3.curveBasis)\n                          .defined(d => d.defined)\n                          .x(function(d) { return x(d.date) })\n                          .y(function(d) { return focusY(d.value) })        \n  focus.append(\"path\")\n      .datum(confirmedData)\n      .attr(\"d\", focusLine)\n      .attr(\"class\", \"context-curve\")\n      .attr(\"stroke\", color(labels[1]))\n  \n  focus.append(\"path\")\n      .datum(aggregateData)\n      .attr(\"d\", focusLine)\n      .attr(\"class\", \"context-curve\")\n      .attr(\"stroke\", color(labels[2]))\n\n  var contextPredCurve = focus.append(\"path\")\n                              .datum(predictionData)\n                              .attr(\"d\", focusPredLine)\n                              .attr(\"class\", \"context-curve\")\n                              .attr(\"stroke\", color(labels[0]))\n  console.log(labels);\n  focus.selectAll(\".forecast-small\")\n        .data(forecastData)\n        .enter()\n        .append(\"path\")\n            .attr(\"d\", line)\n            .attr(\"class\", \"context-curve\")\n            .style(\"stroke\", (f, index) => color(labels[3 + index]))\n            .style(\"stroke-width\", \"2px\");\n\n  function brushed() {\n      if (d3.event.selection) {\n          var extent = d3.event.selection;\n          x.domain([ focusX.invert(extent[0]), focusX.invert(extent[1]) ]);\n          xAxis.call(d3.axisBottom(x))\n          var newX = x(getLastDate(confirmedData));\n          newX = newX < 0 ? 0 : newX;\n          d3\n              .select(\"#prediction-clip\")\n              .select(\"rect\")\n                  .attr(\"width\", width - newX)\n                  .attr(\"x\", newX);\n          d3\n                  .select(\"#confirmed-clip\")\n                  .select(\"rect\")\n                      .attr(\"width\", newX)\n\n          svg\n              .selectAll(\".line\")\n              .attr('d', line)\n\n          svg\n              .select(\"#your-line\")\n              .attr(\"d\", predLine)\n          \n          svg\n              .select(\"#draw-guess\")\n              .attr(\"x\", newX + (width - newX) / 2);\n          svg\n              .select(\"#pointer\")\n              .selectAll(\"circle\")\n                  .attr(\"cx\", newX);\n      }\n  }\n  \n  function brushended() {\n      if (!d3.event.selection) {\n          gb.call(brush.move, defaultSelection);\n      }\n\n  }\n  const gb = focus\n                  .call(brush)\n                  .call(brush.move, defaultSelection);  \n}","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport {cleanPrediction, createFocusContext, savePrediction, getLastDate, createDefaultPrediction, getLastValue, cleanData, clamp, getAllDataPoints, getDataPointsFromPath, reformatData, reformatPredData, getMostRecentPrediction } from '../../utils/data';\nimport './InteractiveChartTemp.css';\n\n\n\nclass InteractiveChartTemp extends Component {\n    constructor(props) {\n        super(props);\n    }\n\n    appendModal() {\n        const signinRedirect = () => {window.location.href='/signin'}\n        const signupRedirect = () => {window.location.href='/signup'}\n        var modal = document.createElement(\"div\");\n        modal.id = \"modal\";\n        var modalContent = document.createElement(\"div\");\n        modalContent.id = \"modal-content\";\n        var text = document.createElement(\"p\");\n        text.innerText = \"Please log in to save your prediction.\";\n        var signinBtn = document.createElement(\"button\");\n        signinBtn.id = \"signin-btn\";\n        signinBtn.innerText = \"Sign In\";\n        signinBtn.onclick= signinRedirect;\n        signinBtn.className = \"btn primary-btn\";\n        var signupBtn = document.createElement(\"button\");\n        signupBtn.id = \"signup-btn\";\n        signupBtn.onclick= signupRedirect;\n        signupBtn.innerText = \"Sign Up\";\n        signupBtn.className = \"btn primary-btn\";\n\n        modalContent.appendChild(text);\n        modalContent.appendChild(signinBtn);\n        modalContent.appendChild(signupBtn);\n        modal.appendChild(modalContent);\n        console.log(modal);\n        console.log(document.querySelector(\".modal\"))\n        document.querySelector(\".chart-container\").append(modal);\n    }\n\n    componentDidMount() {\n        this.props.chart.append(\"rect\")\n        this.renderChart();\n    }\n    renderChart() {\n        const { forecast, orgs, userPrediction, confirmed, confirmedAvg, aggregate, loggedIn, x, y, width, height, predStartDate, xAxis, marginBottom, appendModal} = this.props;\n        console.log(marginBottom);\n        this.appendModal();\n        const predEndDate = x.domain()[1];\n        var svg = this.props.chart;\n        var confirmedData = reformatData(confirmedAvg);\n        const confirmedTemp = reformatData(confirmed);\n        const confirmedLastVal = getLastValue(confirmedTemp);\n        confirmedData.push({\n            date: getLastDate(confirmedTemp),\n            value: confirmedLastVal\n        })\n        console.log(confirmedData)\n        var aggregateData = reformatData(aggregate);\n        var forecastData = forecast.map((f)=> {\n            return cleanData(reformatData(f), predStartDate, confirmedLastVal);\n        });\n        aggregateData = cleanData(aggregateData, predStartDate, confirmedLastVal);\n        var predictionData = userPrediction;\n        var line = d3.line().curve(d3.curveCatmullRom)\n            .x(function(d) { return x(d.date) })\n            .y(function(d) { return y(d.value) })\n        var predLine = d3.line().curve(d3.curveBasis)\n            .defined(d => d.defined)\n            .x(function(d) { return x(d.date) })\n            .y(function(d) { return y(d.value) })\n        const labels = ['User Prediction', 'Confirmed Data', 'Aggregate Data'].concat(orgs);\n        const color = d3\n            .scaleOrdinal()\n            .domain(labels)\n            .range(d3.schemeTableau10);\n        var confirmedBoundary = x(predStartDate);\n        var defs = svg\n            .append(\"defs\");\n        var confirmedClip = defs\n            .append(\"svg:clipPath\")\n                .attr(\"id\", \"confirmed-clip\")\n                .append(\"svg:rect\")\n                    .attr(\"width\", confirmedBoundary)\n                    .attr(\"height\", height)\n                    .attr(\"x\", 0)\n                    .attr(\"y\", 0);\n        const confirmedArea = svg\n                .append('g')\n                .attr(\"clip-path\", \"url(#confirmed-clip)\");\n        var predictionClip = defs\n            .append(\"svg:clipPath\")\n                .attr(\"id\", \"prediction-clip\")\n                .append(\"svg:rect\")\n                    .attr(\"id\", \"prediction-rect\")\n                    .attr(\"width\", width - confirmedBoundary )\n                    .attr(\"height\", height)\n                    .attr(\"x\", confirmedBoundary)\n                    .attr(\"y\", 0);\n        const predictionArea = svg.append('g')\n            .attr(\"clip-path\", \"url(#prediction-clip)\");\n        var confirmedLine = confirmedArea.append(\"path\")\n            .attr(\"class\", \"confirmed line\")\n            .datum(confirmedData)    \n            .attr('d', line)\n            .style(\"stroke\", color(labels[1]))\n            .style(\"stroke-width\", \"3px\")\n        var aggregateLine = predictionArea.append(\"path\")\n            .attr(\"class\", \"aggregate line\")\n            .datum(aggregateData)    \n            .attr('d', line)\n            .style(\"stroke\", color(labels[2]))\n            .style(\"stroke-width\", \"2px\")\n        predictionArea\n            .selectAll(\".forecast\")\n            .data(forecastData)\n            .enter()\n            .append(\"path\")\n                .attr(\"d\", line)\n                .attr(\"id\", (f, index) => orgs[index])\n                .attr(\"class\", \"forecast line\")\n                .style(\"stroke\", (f, index) => color(orgs[index]))\n                .style(\"stroke-width\", \"2px\");\n        \n        ///prediction data////\n        if (loggedIn) {\n            console.log(predEndDate)\n            predictionData = getMostRecentPrediction(userPrediction);\n            console.log(predictionData);\n            if (!predictionData) {\n                predictionData = createDefaultPrediction(predStartDate, predEndDate);\n            }\n            predictionData = cleanPrediction(predictionData, predStartDate, predEndDate, confirmedLastVal);\n        }\n        else {\n            predictionData = createDefaultPrediction(predStartDate, predEndDate);\n        }\n        var filteredData = predictionData.filter(predLine.defined())\n\n        var predictionLine = predictionArea.append(\"path\")\n            .attr(\"class\", \"prediction line\")\n            .datum(predictionData)\n            .attr(\"d\", predLine)\n            .style(\"stroke\", color(labels[0]))\n            .style(\"stroke-width\", \"2px\")\n        \n        const forecastPaths = document.querySelectorAll(\".forecast\");\n        const confirmedPath = document.querySelector(\".confirmed\");\n        const aggregatePath = document.querySelector(\".aggregate\");\n        confirmedData = getAllDataPoints(confirmedPath, x, y, x.domain()[0], predStartDate);\n        aggregateData = getAllDataPoints(aggregatePath, x, y, predStartDate, getLastDate(aggregateData))\n        forecastData.map((f, index) => {\n            forecastData[index] = getAllDataPoints(forecastPaths[index], x, y, predStartDate, getLastDate(f));\n        })\n        var compiledData = [predictionData, confirmedData, aggregateData].concat(forecastData);\n        /////drag/////\n        const mouseArea = svg.append(\"rect\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .attr(\"fill\", \"none\")\n            .attr(\"id\", \"mouse-area\")\n            .style(\"pointer-events\",\"visible\");\n        var drag = d3.drag()\n                        .on(\"drag\", function() {\n                        console.log('yes');\n                        //hide \"draw your guess\" text\n                        var pos = d3.mouse(this);\n                        var date = clamp(predStartDate, predEndDate, x.invert(pos[0]));\n                        var value = clamp(0, y.domain()[1], y.invert(pos[1]));\n                        predictionData.forEach(function(d){\n                            if (+d3.timeDay.round(d.date) === +d3.timeDay.round(date)){\n                                d.value = value;\n                                d.defined = true\n                            }\n                        predictionData[0].value = confirmedLastVal;//make sure the prediction curve is always connected to the confirmed curve\n                        compiledData[0].data = predictionData;\n                        filteredData = predictionData.filter(predLine.defined())\n                        predictionLine.datum(filteredData)\n                                .attr('d', predLine)\n                                .style(\"stroke\", color(labels[0]))\n                                .style(\"stroke-width\", \"2px\")\n                        });\n                    })\n                    .on(\"end\", function () {\n                        if(!loggedIn) {\n                            d3\n                                .select(\"#modal\")\n                                .style(\"display\", \"block\");\n                        }\n                        else {\n                            var lastPredDate = getLastDate(filteredData);\n                            getDataPointsFromPath(predictionData, predictionLine.node(), x, y, lastPredDate);\n                            savePrediction(predictionData, \"us_daily_deaths\");\n                        }\n                    });\n        svg.call(drag)\n\n        var modal = document.getElementById(\"modal\");\n        window.onclick = function(event) {\n            if (event.target === modal) {\n              modal.style.display = \"none\";\n            }\n        }\n        //focus+context//\n        createFocusContext(svg, width, height, marginBottom, confirmedData, aggregateData, forecastData, predictionData, labels, x, y, xAxis, line, predLine, color);\n        ///tooltip///\n    }\n    render() {\n        console.log(this.props.chart.node());\n        return(\n            <div></div>\n        )\n    }\n}\n\nexport default InteractiveChartTemp;","import React, { Component, Fragment } from 'react';\nimport * as d3 from 'd3'\nimport InteractiveChartTemp from '../InteractiveChartTemp';\n\n\nclass ParentChart extends Component {\n    constructor(props) {\n        super(props);\n        this.chartRef = React.createRef();\n        this.state = {\n            chart: null,\n            x: null,\n            y: null,\n            width: 0,\n            height: 0,\n            confirmedStartdate: null,\n            predStartDate: null,\n            predEndDate: null,\n            xAxis: null,\n            marginBottom: 0\n\n        }\n    }\n    appendModal() {\n        const signinRedirect = () => {window.location.href='/signin'}\n        const signupRedirect = () => {window.location.href='/signup'}\n        var modal = document.createElement(\"div\");\n        modal.id = \"modal\";\n        var modalContent = document.createElement(\"div\");\n        modalContent.id = \"modal-content\";\n        var text = document.createElement(\"p\");\n        text.innerText = \"Please log in to save your prediction.\";\n        var signinBtn = document.createElement(\"button\");\n        signinBtn.id = \"signin-btn\";\n        signinBtn.innerText = \"Sign In\";\n        signinBtn.onclick= signinRedirect;\n        signinBtn.className = \"btn primary-btn\";\n        var signupBtn = document.createElement(\"button\");\n        signupBtn.id = \"signup-btn\";\n        signupBtn.onclick= signupRedirect;\n        signupBtn.innerText = \"Sign Up\";\n        signupBtn.className = \"btn primary-btn\";\n\n        modalContent.appendChild(text);\n        modalContent.appendChild(signinBtn);\n        modalContent.appendChild(signupBtn);\n        modal.appendChild(modalContent);\n        //document.querySelector(\".chart-container\").append(modal);\n    }\n\n    componentDidMount() {\n        var chart = this.setUpChart();\n        this.setState({chart: chart})\n    }\n\n    setUpChart() {\n        const { forecast, orgs, userPrediction, confirmed, aggregate, loggedIn, isProfile} = this.props;\n        const legendWidth = 380;\n        const toolTipHeight = 50; //to make sure there's room for the tooltip when the value is 0\n        const focusHeight = 100;\n        const confirmedStartDate = d3.timeParse(\"%Y-%m-%d\")(Object.keys(confirmed)[0]);\n        const predStartDate = d3.timeParse(\"%Y-%m-%d\")(Object.keys(confirmed)[Object.keys(confirmed).length - 1]);\n        const predLength = 155;\n        const predEndDate = d3.timeDay.offset(predStartDate, predLength);\n        this.setState({confirmedStartDate: confirmedStartDate, predStartDate: predStartDate, predEndDate: predEndDate, predLength: predLength});\n        var margin = {top: 20, right: 30, bottom: 20, left: 60},\n            width = 800 - margin.left - margin.right,\n            height = 400 - margin.top - margin.bottom;\n        this.setState({marginBottom: margin.bottom});\n        console.log(margin.bottom, this.state.marginBottom)\n        this.setState({width: width, height: height})\n        var svg = d3.select(\".chart-container\")\n                    .append(\"svg\")\n                        .attr(\"width\", width + margin.left + margin.right + legendWidth)\n                        .attr(\"height\", height + margin.top + margin.bottom + toolTipHeight + focusHeight)\n                    .append(\"g\")\n                    .attr(\"ref\", `${this.chartRef.current}`)\n                    .attr(\"transform\", `translate(${margin.left}, ${margin.top + 20} )`);\n        \n        var x = d3\n                    .scaleTime()\n                    .domain([confirmedStartDate, predEndDate])\n                    .range([ 0, width ])\n                    //.nice(); //rounds up/down the max and mind of x axis\n        var xAxis = svg\n                        .append(\"g\")\n                        .attr(\"transform\", \"translate(0,\" + height + \")\")\n                        .call(d3.axisBottom(x));\n        this.setState({xAxis: xAxis});\n        console.log(xAxis.node());\n        var yMax = d3.max(Object.values(confirmed));\n        forecast.map(f => {\n            var currMax = d3.max(f)\n            yMax = currMax > yMax ? currMax : yMax;\n        })\n        var y = d3.scaleLinear()\n            .domain([0, yMax])\n            .range([ height, 0 ])\n            .nice();\n        this.setState({x: x, y: y});\n\n        svg\n            .append(\"g\")\n            .call(d3.axisLeft(y));\n        return svg;\n    }\n\n    render() {\n        const { forecast, orgs, userPrediction, confirmed, confirmedAvg, aggregate, loggedIn } = this.props;\n        console.log(forecast)\n        if(!this.state.chart || !this.state.marginBottom) return \"Loading\"\n        return(\n            <Fragment>\n                {!this.props.isProfile ? \n                <h1>UserPredictionChart</h1> : \n                <InteractiveChartTemp \n                    chart={this.state.chart}\n                    forecast={forecast}\n                    orgs={orgs}\n                    userPrediction={userPrediction}\n                    confirmed={confirmed}\n                    confirmedAvg={confirmedAvg}\n                    aggregate={aggregate}\n                    loggedIn={loggedIn}\n                    x={this.state.x}\n                    y={this.state.y}\n                    width={this.state.width}\n                    height={this.state.height}\n                    predStartDate={this.state.predStartDate}\n                    xAxis={this.state.xAxis}\n                    marginBottom = {this.state.marginBottom}\n                    appendModal={this.appendModal()}\n                />}\n            </Fragment>\n        )\n    }\n}\n\nexport default ParentChart;","import React from 'react';\nimport ParentChart from '../../components/ParentChart';\n\nimport { cleanConfirmedData, organizeData } from '../../utils/data';\n\nclass ChartContainer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      forecast: null,\n      orgs: null,\n      confirmed: null,\n      confirmedAvg: null,\n      userPrediction: null,\n      aggregate: null,\n      loggedIn: false\n    };\n  }\n\n  componentDidMount() {\n    fetch('/us-inc-deaths-forecasts').then(res => res.json()).then(data => {\n      const [results, orgs] = organizeData(data);\n      this.setState({ forecast: results, orgs });\n    });\n    fetch('/user-prediction?category=us_daily_deaths').then(res => res.json()).then(data => {\n        this.setState({ userPrediction: data });\n    });\n    fetch('/us-inc-deaths-confirmed').then(res => res.json()).then(data => {\n        this.setState({ confirmed: data });\n    });\n    fetch('/us-inc-deaths-confirmed-wk-avg').then(res => res.json()).then(data => {\n      this.setState({ confirmedAvg: data });\n    });\n    fetch('/us-agg-inc-deaths').then(res => res.json()).then(data => {\n        this.setState({ aggregate: data });\n    });\n    fetch('/login-status/').then(res => res.json()).then(data => {\n        this.setState({ loggedIn: data['logged in'] });\n    });\n  }\n\n  render() {\n    const { forecast, orgs, userPrediction, confirmed, confirmedAvg, aggregate, loggedIn } = this.state;\n    if (!forecast || !orgs || !userPrediction || !confirmed || !aggregate || !loggedIn) return 'Loading...';\n    const isProfile = this.props.isProfile;\n\n    return (\n      <div className=\"chart-container\">\n        <ParentChart\n          forecast={forecast}\n          orgs={orgs}\n          userPrediction={userPrediction}\n          confirmed={confirmed}\n          confirmedAvg={confirmedAvg}\n          aggregate={aggregate}\n          loggedIn={loggedIn}\n          isProfile={isProfile}\n          //category={\"us_daily\"}\n        />\n      </div>\n    );\n  }\n}\n\nexport default ChartContainer;\n","import React, { Component } from 'react';\n\nconst pstyle = {\n    textAlign: 'left',\n    marginLeft: '20px',\n    fontSize: '20px',\n    paddingLeft: '100px',\n    paddingRight: '100px'\n}\n\nconst h1style = {\n    textAlign: 'left',\n    marginLeft: '20px',\n    fontSize: '40px',\n    paddingLeft: '100px',\n    paddingRight: '100px'\n}\n\nclass AboutPage extends Component {\n    render() {\n        return(\n            <div>\n                <br></br>\n                <h1 style={h1style}>About</h1>\n                <h3></h3>\n                <p style={pstyle}> \n                    This site aims to show various past data readings of coronavirus data, as well as future predictions from various sources. \n                    Different forecasts relating to the COVID-19 pandemic are displayed, and users can make their own predictions about the future trajectory of \n                    factors relating to the pandemic such as daily deaths, hospitalizations and cases.\n                    Our mission is to deliver future projections and collected data by providing the best information on the COVID-19 pandemic.\n                </p>\n                <br></br>\n                <h1 style={h1style}>Privacy</h1>\n                {/*<h3 style={h1style}>How we Score</h3>*/}\n                <p style={pstyle}>User-contributed forecast data is used to create aggregate forecasts and is displayed to other visitors on the \"Top Forecasts\" page. It may also be used, anonymized, for academic research purposes. Other than that, we do not and will not share or sell any user or visitor information for any reason.</p>\n\n                <small>Created by the Aggregators Team of the <a href='http://www.covideas20reu.org'>COV-IDEAS 2020 REU</a></small>\n            </div>\n        );  \n    }\n}\n\nexport default AboutPage;","import React, { Component } from 'react';\n\nclass LandingPage extends Component {\n\n    render() {\n        return (\n            <div>\n                <div class=\"container landing\">\n                    <h1 class=\"logo\">COVID-19 Prediction</h1>\n                </div>\n                <div class=\"landing\">\n                    <div class=\"title\"> Welcome<br/>\n                        <button class=\"button\"><b><a href=\"#\">Start</a></b></button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default LandingPage;","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport './LeaderboardChart.css';\n\nclass LeaderboardChart extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { \n            userPrediction: null,\n            confirmed: null,\n         };\n        this.chartRef = React.createRef();\n    }\n\n    componentDidMount() {\n        this.setState({userPrediction: this.props.userPrediction, confirmed: this.props.confirmed});\n        this.renderChart();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // only update chart if the data has changed\n        if (prevProps.userPrediction !== this.props.userPrediction) {\n            this.renderChart();\n        }\n    }\n\n\n    renderChart() {\n        var { userPrediction, confirmed } = this.props;\n\n        //format confirmedData, predictionData\n        var confirmedData = Object.keys(confirmed).map(key => ({\n            date: d3.timeParse(\"%Y-%m-%d\")(key),\n            value: confirmed[key]\n        }));\n        var predictionData = userPrediction.map(d => ({\n            date: d3.timeParse(\"%Y-%m-%d\")((d.date).substring(0,10)),\n            value: d.value\n        }));\n\n        //IMPORTANT BOUNDARIES// \n        const confirmedStartDate = d3.timeParse(\"%Y-%m-%d\")(\"2020-02-01\");\n        var predEndDate = predictionData[predictionData.length - 1].date;\n        const valueMax = 5000;\n\n        /////////////////////////////////DRAW CHART//////////////////////////////\n        //set up margin, width, height of chart\n        const legendWidth = 180;\n        const toolTipHeight = 50; //to make sure there's room for the tooltip when the value is 0\n        const contextHeight = 100;\n        var margin = {top: 20, right: 30, bottom: 20, left: 60},\n            width = 600 - margin.left - margin.right,\n            height = 300 - margin.top - margin.bottom;\n        var svg = d3.select(this.chartRef.current)\n                    .append(\"svg\")\n                        //.attr(\"width\", width + margin.left + margin.right + legendWidth)\n                        //.attr(\"height\", height + margin.top + margin.bottom + toolTipHeight + contextHeight)\n                        .attr(\"viewBox\", `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom + contextHeight + 100}`)\n                        .attr('preserveAspectRatio','xMinYMin meet')\n                    .append(\"g\")\n                        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n        \n        //Create X axis label   \n        svg.append(\"text\")\n            .attr(\"x\", width/2)\n            .attr(\"y\", height + 2*margin.bottom)\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Date\");\n            \n        //Create Y axis label\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - margin.left)\n            .attr(\"x\", 0 - (height/2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Daily Deaths\");\n\n        var x = d3\n                    .scaleTime()\n                    .domain([confirmedStartDate, predEndDate])\n                    .range([0, width]);\n        var xAxis = svg\n                        .append(\"g\")\n                        .attr(\"transform\", \"translate(0,\" + height + \")\")\n                        .call(d3.axisBottom(x));\n        var y = d3\n                    .scaleLinear()\n                    .domain([0, valueMax])\n                    .range([height, 0]);\n        var yAxis = svg\n                        .append(\"g\")\n                        .call(d3.axisLeft(y));\n        \n        //DRAW LEGEND//\n        const legendString = [\"Daily Confirmed Deaths\", \"User Prediction\"];\n        const color = d3\n                        .scaleOrdinal()\n                        .domain(legendString)\n                        .range(d3.schemeTableau10);\n\n        var legend = svg\n                        .append('g')\n                        .attr(\"viewBox\", \"0 0 400 500\")\n                        .append('g')\n                        .attr(\"id\", \"legend\");\n\n        legend\n                .selectAll(\"rect\")\n                .data(legendString)\n                .enter()\n                .append(\"circle\")\n                    .attr('cx', width*3/5+40)\n                    //.attr('cx', width-65)\n                    .attr(\"cy\", function(d,i){ return 0 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                    .attr(\"r\", 6)\n                    .style(\"fill\", function(d){ return color(d)});\n        legend\n                .selectAll(\"labels\")\n                .data(legendString)\n                .enter()\n                .append(\"text\")\n                    .attr(\"x\", width*3/5+60)\n                    //.attr(\"x\", width-50)\n                    .attr(\"y\", function(d,i){ return 0 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                    .style(\"fill\", function(d){ return 'black'})\n                    .text(function(d){ return d})\n                        .attr(\"text-anchor\", \"left\")\n                        .style(\"alignment-baseline\", \"middle\");\n\n        //SET UP CLIP PATH//\n        var mainClip = svg\n                            .append(\"defs\")\n                            .append(\"svg:clipPath\")\n                                .attr(\"id\", \"main-clip\")\n                                .append(\"svg:rect\")\n                                    .attr(\"width\", width )\n                                    .attr(\"height\", height )\n                                    .attr(\"x\", 0)\n                                    .attr(\"y\", 0);\n        const mainArea = svg.append(\"g\")\n                            .attr(\"clip-path\", \"url(#main-clip)\");\n        \n        //SET UP CURVES//\n        const lineGenerator = d3.line()\n                                .curve(d3.curveCatmullRom);\n        const predLineGenerator = d3.line()\n                                    .curve(d3.curveBasis);\n        var line = lineGenerator\n                        .x(function(d) { return x(d.date) })\n                        .y(function(d) { return y(d.value) });\n        var predLine = predLineGenerator\n                            .x(function(d) { return x(d.date) })\n                            .y(function(d) { return y(d.value) });\n\n        //DRAW CURVES//\n        var confirmedCurve = mainArea\n                                    .append(\"path\")\n                                    .attr(\"id\", \"lbConfirmed\")\n                                    .attr(\"class\", \"line\")\n                                    .datum(confirmedData)\n                                    .attr(\"d\", line)\n                                    .attr(\"stroke\", color(legendString[0]));\n        var predCurve = mainArea\n                                .append(\"path\")\n                                .attr(\"id\", \"lbPrediction\")\n                                .attr(\"class\", \"line\")\n                                .datum(predictionData)\n                                .attr(\"d\", predLine)\n                                .attr(\"stroke\",  color(legendString[1]));\n\n        ////ADD TODAY LINE/////////////////////////////////////////////////////\n        const today = d3.timeParse(\"%Y-%m-%d\")(new Date().toISOString().substring(0,10));\n        var todayMarker = svg\n                            .append(\"g\")\n                            .attr(\"id\", \"today-marker\");\n        todayMarker\n                    .append(\"line\")\n                    .attr(\"id\", \"today-line\")\n                    .attr(\"x1\", x(today))\n                    .attr(\"x2\", x(today))\n                    .attr(\"y1\", 0)\n                    .attr(\"y2\", height)\n                    .attr(\"stroke\", \"black\")\n                    .attr(\"stroke-width\", 1)\n                    .attr(\"stroke-dasharray\", \"8, 8\");\n        todayMarker\n                    .append(\"text\")\n                    .attr(\"id\", \"today-text\")\n                    .attr(\"transform\", `translate(${x(today) + 17}, 0) rotate(-90)`)\n                    .text(\"Today\")\n                    .style(\"text-anchor\", \"end\");\n        \n    }\n\n    render() {\n        return(\n            <div style={{padding: \"20px\"}} ref={this.chartRef}></div>\n        );\n    }\n}\n\nexport default LeaderboardChart;\n","var colors = {\n    'Columbia': 'rgb(172, 204, 230)',\n    'Georgia Tech': 'rgb(179, 163, 105)',\n    'UCLA': 'rgb(39, 116, 174)',\n    'IHME': 'rgb(87, 175, 85)',\n    'Youyang Gu': 'rgb(196, 129, 14)'\n}\n\nexport default colors;","import React from 'react';\nimport { useTable } from 'react-table';\nimport $ from 'jquery';\nimport ReactDOM from 'react-dom';\n\nimport LeaderboardChart from '../LeaderboardChart';\nimport colors from '../../constants/colors';\n\n\n// Create leaderboard table, consisting of user predictions and official forecasts\nfunction Table({ columns, data, confirmed, orgs, forecasts, style }) {\n  // Use the state and functions returned from useTable to build UI\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable({\n    columns,\n    data,\n    confirmed,\n    orgs,\n    forecasts,\n    style\n  });\n\n  // Render the UI for table\n  return (\n    <table style={style} className=\"table table-bordered table-hover table-sm\" {...getTableProps()}>\n      <thead className=\"thead-dark\">\n        {headerGroups.map(headerGroup => (\n          <tr {...headerGroup.getHeaderGroupProps()}>\n            {headerGroup.headers.map(column => (\n              <th id={column.render('Header')} {...column.getHeaderProps()}>{column.render('Header')}</th>\n            ))}\n          </tr>\n        ))}\n      </thead>\n      <tbody {...getTableBodyProps()}>\n        {<RenderOrgsTable orgs={orgs} forecasts={forecasts} confirmed={confirmed} />}\n        {<RenderUsersTable users={data} confirmed={confirmed} />}\n      </tbody>\n    </table>\n  )\n}\n\n\nvar selectedID = \"\"; // var used to keep chart in place if same row was clicked\n// Display user's prediction when user's row is clicked on\nfunction createUserChart(user, confirmed, id) {\n  $('tr').removeClass('clicked');\n  $('#' + id).addClass('clicked');\n  if (selectedID !== id) {\n    $('#predictionChart div').empty(); // reset predictionChart\n  }\n  selectedID = id;\n  ReactDOM.render(<LeaderboardChart userPrediction={user.prediction} confirmed={confirmed} />, document.getElementById('predictionChart'));\n}\n\n// Display official forecaster's prediction when its row is clicked on\nfunction createOrgChart(org, confirmed, id) {\n  var data = [];\n  for (var i = 0; i < org['target_end_date'].length; i++) {\n    var temp = {}\n    temp['date'] = org['target_end_date'][i]\n    temp['value'] = org['value'][i];\n    data.push(temp);\n  }\n  \n  $('tr').removeClass('clicked');\n  $('#' + id).addClass('clicked');\n  if (selectedID !== id) {\n    $('#predictionChart div').empty(); // reset predictionChart\n  }\n  selectedID = id;\n  ReactDOM.render(<LeaderboardChart userPrediction={data} confirmed={confirmed} />, document.getElementById('predictionChart'));\n}\n\n\n// Add rows with user data to the leaderboard table\nfunction RenderUsersTable({ users, confirmed }) {\n  return users.map((user, index) => {\n    // ignore null MSE values\n    if (user.mse_score == null) {\n      return;\n    }\n    return (\n       <tr id={user.username + user.date} onClick={() => createUserChart(user, confirmed, user.username + user.date)}>\n          <td>{user.username}</td>\n          <td>{user.date}</td>\n          <td>{user.mse_score.toFixed(2)}</td>\n       </tr>\n    );\n });\n}\n\n\n// Add rows with official forecast data to the leaderboard table\nfunction RenderOrgsTable({ orgs, forecasts, confirmed }) {\n  return Object.entries(orgs).map( ([key, value]) => {\n    // ignore null MSE values\n    if (value == null) {\n      return;\n    }\n    return (\n      <tr id={key} style={{backgroundColor: colors[key]}} onClick={() => createOrgChart(forecasts[key], confirmed, key)}>\n          <td>{key}*</td>\n          <td>Ongoing</td>\n          <td>{value.toFixed(2)}</td>\n      </tr>\n    );\n  });\n}\n\n\n\nclass Leaderboard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      users: null,\n      columns: null,\n      confirmed: null,\n      orgs: null,\n      forecasts: null\n    }\n  }\n\n  componentDidMount() {\n    fetch('/user-data').then(res => res.json()).then(data => {\n      this.setState({ users: data });\n    });\n    fetch('/us-mse').then(res => res.json()).then(data => {\n      this.setState({ orgs: data });\n    });\n\n    this.setState({ columns: [\n        {\n          Header: 'Username/Official Forecaster',\n          accesor: 'username',\n        },\n        {\n          Header: 'Prediction Date/Status',\n          accesor: 'date',\n        },\n        {\n          Header: 'MSE',\n          accesor: 'mse_score',\n        }\n      ]\n    });\n\n    fetch('/us-inc-deaths-confirmed-wk-avg').then(res => res.json()).then(data => {\n      this.setState({ confirmed: data });\n    });\n\n    fetch('/us-inc-deaths-forecasts').then(res => res.json()).then(data => {\n      this.setState({ forecasts: data });\n    });\n\n  }\n\n\n  componentDidUpdate(prevProps, prevState) {\n    // Table should sort by error when MSE header is clicked on\n    $('#MSE').click(function() {\n      if (this.asc === undefined) {\n          this.asc = true;\n      }\n      var table = $(this).parents('table').eq(0)\n      var rows = table.find('tr:gt(0)').toArray().sort(comparer($(this).index()))\n      this.asc = !this.asc\n    \n      if (!this.asc){\n          rows = rows.reverse()\n      }\n      for (var i = 0; i < rows.length; i++) {\n          table.append(rows[i])\n      }\n    })\n    function comparer(index) {\n        return function(a, b) {\n            var valA = getCellValue(a, index), valB = getCellValue(b, index)\n            return $.isNumeric(valA) && $.isNumeric(valB) ? valA - valB : valA.toString().localeCompare(valB)\n        }\n    }\n    function getCellValue(row, index){ \n        return $(row).children('td').eq(index).text() \n    }\n\n    // Trigger click events to get orgs and users sorted together\n    $('#MSE').trigger(\"click\");\n    $('#MSE').trigger(\"click\");\n  }\n\n\n  render() {\n    const tableStyle = {\n      width: \"50%\",\n      textAlign: \"center\",\n      overflowY: \"scroll\"\n    };\n    \n    const chartStyle = {\n      position: \"fixed\",\n      width: \"50%\",\n      left: \"50%\",\n    };\n\n    $(\"#delete-btn\").remove();\n\n    const { users, columns, confirmed, orgs, forecasts } = this.state;\n    if (!users || !columns || !confirmed || !orgs || !forecasts) return 'Loading...';\n\n    return (\n      <div>\n        <br></br>\n        <h2 style={{marginBottom: 0}}>Top Forecasts</h2>\n        <small>* indicates an official forecaster as labelled by the CDC</small>\n        <br></br>\n        <br></br>\n        <div className=\"d-flex flex-row\">>\n          <Table id=\"leaderboard\" columns={columns} data={users} confirmed={confirmed} orgs={orgs} forecasts={forecasts} style={tableStyle} />\n          <div id=\"predictionChart\" className=\"text-center\" style={chartStyle}>Click on a row to display a user's prediction!</div>\n        </div>\n      </div>\n    );\n  }\n}\n\n\nexport default Leaderboard;\n","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport './UserPredictionChart.css';\nimport { getMostRecentPrediction, getAllDataPoints, sortDictByDate, sortStringDates } from '../../utils/data';\n\nclass UserPredictionChart extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { category: \"us_daily_deaths\" };\n        this.chartRef = React.createRef();\n    }\n\n    componentDidMount() {\n        const userStatus = this.props.userStatus;\n        console.log(userStatus)\n        if (userStatus['logged in']) {\n            this.renderChart();\n        }\n        else {\n            this.chartRef.current.innerHTML = \"Please log in\"\n        }\n    }\n    renderChart() {\n        const { forecast, orgs, userPrediction, confirmed, aggregate } = this.props;\n        var predictionData = {};//where we will store formatted userPrediction\n        const category = this.state.category;\n        var compiledData = [];\n\n        //format confirmedData, forecastData, and predictionData into a list of js objects, convert date from string to js date object\n        var confirmedData = Object.keys(confirmed).map(key => ({\n            date: d3.timeParse(\"%Y-%m-%d\")(key),\n            value: confirmed[key]\n        }));\n\n        console.log(\"USER PREDICTION\");\n        console.log(userPrediction);\n\n        //store userPrediction in predictionData if it exists; parse dates and store as d3 date objects\n        if(Object.keys(userPrediction).length > 0) {\n            Object.keys(userPrediction).map(p => {\n                predictionData[p]= userPrediction[p].map(d => ({\n                    date: d3.timeParse(\"%Y-%m-%d\")((d.date).substring(0,10)),\n                    value: d.value,\n                    defined: d.defined\n                }))\n            })\n        }\n\n        predictionData = sortDictByDate(predictionData);\n        console.log(\"PREDICTION DATA\");\n        console.log(predictionData);\n\n        console.log(predictionData)\n        //get most recent prediction\n        var dates = sortStringDates(Object.keys(userPrediction))\n        const mostRecentPred = predictionData[dates[dates.length - 1]]\n        console.log(\"MOST RECENT PRED\");\n        console.log(mostRecentPred)\n        //push to compiledData\n        compiledData = [confirmedData, mostRecentPred]\n        console.log(dates[0])\n        console.log(d3.timeFormat(\"%B %d, %Y\")(dates[0]))\n    \n\n        //IMPORTANT BOUNDARIES// \n        const confirmedStartDate = d3.timeParse(\"%Y-%m-%d\")(\"2020-02-01\");\n        const predEndDate = mostRecentPred[mostRecentPred.length - 1].date;\n        const valueMax = 5000;\n        \n\n        /*dateList.map(d => {\n            dates.push({\n                date: d\n            })\n        })*/\n\n        /////////////////////////////////////////////////DRAW CHART//////////////////////////////\n        //set up margin, width, height of chart\n        const legendWidth = 180;\n        const toolTipHeight = 50; //to make sure there's room for the tooltip when the value is 0\n        const contextHeight = 100;\n        var margin = {top: 20, right: 30, bottom: 20, left: 60},\n            width = 800 - margin.left - margin.right,\n            height = 400 - margin.top - margin.bottom;\n        var svg = d3.select(this.chartRef.current)\n                    .append(\"svg\")\n                        .attr(\"width\", width + margin.left + margin.right + legendWidth)\n                        .attr(\"height\", height + margin.top + margin.bottom + toolTipHeight + contextHeight)\n                    .append(\"g\")\n                        .attr(\"transform\",\n                        \"translate(\" + margin.left + \",\" + margin.top + \")\");\n        \n        //Create X axis label   \n        svg.append(\"text\")\n            .attr(\"x\", width/2)\n            .attr(\"y\", height + 2*margin.bottom)\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Date\");\n            \n        //Create Y axis label\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - margin.left)\n            .attr(\"x\", 0 - (height/2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Daily Deaths\");\n\n        var x = d3\n                    .scaleTime()\n                    .domain([confirmedStartDate, predEndDate])\n                    .range([0, width]);\n        var xAxis = svg\n                        .append(\"g\")\n                        .attr(\"transform\", \"translate(0,\" + height + \")\")\n                        .call(d3.axisBottom(x));\n        var y = d3\n                    .scaleLinear()\n                    .domain([0, valueMax])\n                    .range([height, 0]);\n        var yAxis = svg\n                        .append(\"g\")\n                        .call(d3.axisLeft(y));\n        \n        //DRAW LEGEND//\n        const legendString = [\"Daily Confirmed Deaths\", \"User Prediction\"];\n        const color = d3\n                        .scaleOrdinal()\n                        .domain(legendString)\n                        .range(d3.schemeTableau10);\n        const legend = svg\n                            .append('g')\n                            .attr(\"id\", \"legend\");\n        legend\n                .selectAll(\"rect\")\n                .data(legendString)\n                .enter()\n                .append(\"circle\")\n                    .attr('cx', width + 30)\n                    .attr(\"cy\", function(d,i){ return 20 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                    .attr(\"r\", 6)\n                    //.attr(\"width\", size)\n                    //.attr(\"height\", size)\n                    .style(\"fill\", function(d){ return color(d)})\n        legend\n                .selectAll(\"labels\")\n                .data(legendString)\n                .enter()\n                .append(\"text\")\n                    .attr(\"x\", width + 45)\n                    .attr(\"y\", function(d,i){ return 20 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                    .style(\"fill\", function(d){ return color(d)})\n                    .text(function(d){ return d})\n                        .attr(\"text-anchor\", \"left\")\n                        .style(\"alignment-baseline\", \"middle\")\n        \n        //DRAW TODAY LINE//\n        const today = d3.timeParse(\"%Y-%m-%d\")(new Date().toISOString().substring(0,10));\n        console.log(today);\n        var todayMarker = svg\n                            .append(\"g\")\n                            .attr(\"id\", \"today-marker\")\n        todayMarker\n                    .append(\"line\")\n                    .attr(\"id\", \"today-line\")\n                    .attr(\"x1\", x(today))\n                    .attr(\"x2\", x(today))\n                    .attr(\"y1\", 0)\n                    .attr(\"y2\", height)\n                    .attr(\"stroke\", \"black\")\n                    .attr(\"stroke-width\", 1)\n                    .attr(\"stroke-dasharray\", \"8, 8\")\n        todayMarker\n                    .append(\"text\")\n                    .attr(\"id\", \"today-text\")\n                    .attr(\"transform\", `translate(${x(today) + 17}, 0) rotate(-90)`)\n                    .text(\"Today\")\n                    .style(\"text-anchor\", \"end\")\n\n        //SET UP CLIP PATH//\n        var mainClip = svg\n                            .append(\"defs\")\n                            .append(\"svg:clipPath\")\n                                .attr(\"id\", \"main-clip\")\n                                .append(\"svg:rect\")\n                                    .attr(\"width\", width )\n                                    .attr(\"height\", height )\n                                    .attr(\"x\", 0)\n                                    .attr(\"y\", 0);\n        const mainArea = svg.append(\"g\")\n                            .attr(\"clip-path\", \"url(#main-clip)\");\n        \n        //SET UP CURVES//\n        const lineGenerator = d3.line()\n                                .curve(d3.curveCatmullRom);\n        const predLineGenerator = d3.line()\n                                    .curve(d3.curveBasis);\n        const line = lineGenerator\n                        .x(function(d) { return x(d.date) })\n                        .y(function(d) { return y(d.value) })\n        const predLine = predLineGenerator\n                            .defined(d => d.defined)\n                            .x(function(d) { return x(d.date) })\n                            .y(function(d) { return y(d.value) })\n        //DRAW CURVES//\n        var confirmedCurve = mainArea\n                                    .append(\"path\")\n                                    .attr(\"id\", \"confirmed\")\n                                    .attr(\"class\", \"line\")\n                                    .datum(confirmedData)\n                                    .attr(\"d\", line)\n                                    .attr(\"stroke\", color(legendString[0]))\n        var predCurve = mainArea\n                                .append(\"path\")\n                                .attr(\"id\", \"prediction\")\n                                .attr(\"class\", \"line\")\n                                .datum(mostRecentPred.filter(predLine.defined()))\n                                .attr(\"d\", predLine)\n                                .attr(\"stroke\",  color(legendString[1]))\n        \n        //SET UP TOOLTIP//\n        const tooltip = svg \n                            .append(\"g\")\n                            .attr(\"class\", \"tooltip\")\n        tooltip\n                .append(\"path\")\n                .attr(\"id\", \"tooltip-line\")\n                .style(\"stroke\", \"black\")\n                .style(\"stroke-width\", \"0.5px\")\n                .style(\"display\", \"none\");\n        var mousePerLine = tooltip\n                                    .selectAll(\".mouse-per-line\")\n                                    .data(compiledData)\n                                    .enter()\n                                    .append(\"g\")\n                                    .attr(\"class\", \"mouse-per-line\");\n        mousePerLine.append(\"circle\")\n                    .attr(\"r\", 2)\n                    .style(\"stroke\", function(d, index) {\n                        return color(legendString[index]);\n                    })\n                    .attr(\"id\", \"circle\")\n                    .style(\"fill\", \"none\")\n                    .style(\"stroke-width\", \"1px\")\n                    .style(\"display\", \"none\");\n        mousePerLine.append(\"text\")\n                    .attr(\"id\", \"value\")\n                    .attr(\"transform\", \"translate(10,3)\"); \n        mousePerLine.append(\"text\")\n                    .attr(\"id\", \"date\")\n                    .attr(\"text-anchor\", \"end\")\n                    .attr(\"transform\", \"rotate(-90)\")\n        \n        svg\n                .append(\"svg:rect\")\n                    .attr('width', width)\n                    .attr('height', height)\n                    .attr(\"id\", \"interactive-area\")\n                    .attr('fill', 'none')\n                    .attr('pointer-events', 'all')\n                    .style(\"cursor\", \"pointer\")\n                    .on('mouseout', function() { // on mouse out hide line, circles and text\n                        d3.select(\"#tooltip-line\")\n                            .style(\"display\", \"none\");\n                        d3.selectAll(\".mouse-per-line circle\")\n                            .style(\"display\", \"none\");\n                        d3.selectAll(\".mouse-per-line text\")\n                            .style(\"display\", \"none\")\n                    })\n                    .on('mouseover', function() { // on mouse in show line, circles and text\n                        d3.select(\"#tooltip-line\")\n                            .style(\"display\", \"block\");\n                    })\n                    .on('mousemove', function() { // mouse moving over canvas\n                        var todayDate = new Date();\n                        todayDate = d3.timeParse(\"%Y-%m-%d\")(todayDate.toISOString().substring(0,10));\n                        var date = x.invert(d3.mouse(this)[0])\n                        if (+date > +todayDate) {\n                            date = todayDate;\n                        }\n                        const index = d3.bisectRight(dates, date);\n                        if(predictionData[date]) {\n                            console.log(\"exists\")\n                            svg\n                                .select(\"#prediction\")\n                                .datum(predictionData[date].filter(predLine.defined()))\n                                .attr(\"d\", predLine)\n                            compiledData[1] = predictionData[date];\n                        }\n                        else {\n                            if (index === 0) {\n                                svg\n                                    .select(\"#prediction\")\n                                    .datum([])\n                                    .attr(\"d\", predLine)\n                                compiledData[1] = [];\n                            }\n                            else {\n                                var newDate = dates[index - 1];\n                                console.log(+predictionData[newDate][0].date, +date);\n                                var pred = predictionData[newDate].filter(d => +d.date >= +date)\n                                console.log(pred)\n                                svg\n                                    .select(\"#prediction\")\n                                    .datum(pred.filter(predLine.defined()))\n                                    .attr(\"d\", predLine);\n                                compiledData[1] = pred;\n                            }\n                        }\n                        mousePerLine.data(compiledData);\n                        ////////////////////\n\n\n\n                        var mouse = d3.mouse(this);\n                        var xCoord = mouse[0];\n                        d3\n                            .select(\"#tooltip-line\")\n                            .attr(\"d\", function() {\n                                var d = \"M\" + xCoord + \",\" + height;\n                                d += \" \" + xCoord + \",\" + 0;\n                                return d;\n                            });\n                        d3\n                            .selectAll(\".mouse-per-line\")\n                            .attr(\"transform\", function(d, i) {\n                                if (d.length === 0) {return;}\n                                var date = x.invert(xCoord);\n                                const index = d3.bisector(f => f.date).left(d, date);\n                                var a = null;\n                                if (index > 0) {\n                                    a = d[index - 1];\n                                }\n                                const b = d[index];\n                                //d = the data object corresponding to date and value pointed by the cursors\n                                var data = null;\n                                if (!a) {\n                                    data = b;\n                                }\n                                else if (!b) {\n                                    data = a;\n                                }\n                                else {\n                                    data = b && (date - a.date > b.date - date) ? b : a;\n                                }\n                                if (+d3.timeDay.floor(date) === +data.date || +d3.timeDay.ceil(date) === +data.date) {\n                                    if (data.defined != 0) {\n                                        var element = d3.select(this)\n                                        element\n                                                .select('#value')\n                                                .style(\"display\", \"block\")\n                                                .text(Math.round(data.value))\n                                                .attr(\"transform\", `translate(${mouse[0]}, ${y(data.value)})`);\n                                            \n                                        element\n                                                .select(\"#date\")\n                                                .style(\"display\", \"block\")\n                                                .attr(\"transform\", `translate(${mouse[0] + 15}, 0) rotate(-90)`)\n                                                .text(d3.timeFormat(\"%B %d, %Y\")(data.date));\n                                        element\n                                                .select(\"circle\")\n                                                .style(\"display\", \"block\")\n                                                .attr(\"transform\", `translate(${mouse[0]}, ${y(data.value)})`);\n                                        return \"translate(0,0)\";\n                                    }\n                                }\n                                var element = d3.select(this)\n                                element                \n                                    .selectAll(\"text\")\n                                        .style(\"display\", \"none\")\n                                element\n                                        .select(\"circle\")\n                                        .style(\"display\", \"none\");\n                            });\n                    })\n                    .on(\"click\", function() {\n                        var date = x.invert(d3.mouse(this)[0])\n                        const index = d3.bisectRight(dates, date);\n                        console.log(dates)\n                        console.log(date)\n                        console.log(index)\n                        if(predictionData[date]) {\n                            console.log(\"exists\")\n                            svg\n                                .select(\"#prediction\")\n                                .datum(predictionData[date].filter(predLine.defined()))\n                                .attr(\"d\", predLine)\n                            compiledData[1] = predictionData[date];\n                        }\n                        else {\n                            if (index === 0) {\n                                svg\n                                    .select(\"#prediction\")\n                                    .datum([])\n                                    .attr(\"d\", predLine)\n                                compiledData[1] = [];\n                            }\n                            else {\n                                var newDate = dates[index - 1];\n                                console.log(+predictionData[newDate][0].date, +date);\n                                var pred = predictionData[newDate].filter(d => +d.date >= +date)\n                                console.log(pred)\n                                svg\n                                    .select(\"#prediction\")\n                                    .datum(pred.filter(predLine.defined()))\n                                    .attr(\"d\", predLine);\n                                compiledData[1] = pred;\n                            }\n                        }\n                        mousePerLine.data(compiledData);\n                    })\n                \n    }\n\n    render() {\n        return(<div ref={this.chartRef}></div>);\n    }\n}\n\nexport default UserPredictionChart;\n","import React, { Component } from 'react';\nimport UserPredictionChart from '../../components/UserPredictionChart';\nimport { cleanConfirmedData, organizeData } from '../../utils/data';\n\nclass UserPredictionChartContainer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            forecast: null,\n            orgs: null,\n            confirmed: null,\n            userPrediction: null,\n            aggregate: null,\n            userStatus: null\n        };\n    }\n\n    componentDidMount() {\n        fetch('/us-inc-deaths-forecasts').then(res => res.json()).then(data => {\n            const [results, orgs] = organizeData(data);\n            this.setState({ forecast: results, orgs });\n        });\n            fetch('/user-prediction?category=us_daily_deaths').then(res => res.json()).then(data => {\n            this.setState({ userPrediction: data });\n        });\n        fetch('/us-inc-deaths-confirmed-wk-avg').then(res => res.json()).then(data => {\n            //const result = JSON.parse(data);\n            this.setState({ confirmed: data });\n        });\n        fetch('/us-agg-inc-deaths').then(res => res.json()).then(data => {\n            this.setState({ aggregate: data });\n        });\n        fetch('/login-status/').then(res => res.json()).then(data => {\n            this.setState({ userStatus: data });\n            console.log(data);\n        });\n    }\n    render() {\n        const { forecast, orgs, userPrediction, confirmed, aggregate, userStatus } = this.state;\n        if (!forecast || !orgs || !userPrediction || !confirmed || !aggregate || !userStatus) return 'Loading...';\n\n        return (\n            <div className=\"chartContainer\">\n                <UserPredictionChart\n                    forecast={forecast}\n                    orgs={orgs}\n                    userPrediction={userPrediction}\n                    confirmed={confirmed}\n                    aggregate={aggregate}\n                    userStatus={userStatus}\n                />\n            </div>\n        );\n    }\n}\n\nexport default UserPredictionChartContainer;","import React from 'react';\nimport UserPredictionChartContainer from '../../containers/UserPredictionChartContainer';\n\nclass ProfilePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      user: null\n    }\n  }\n\n  componentDidMount() {\n    /*fetch('/user').then(res => res.json()).then(data => {\n      this.setState({ user: data });\n    });*/\n  }\n\n  \n\n  renderUser() {\n    return (\n      <div>\n        <h3>My Predictions</h3>\n        <UserPredictionChartContainer/>\n      </div>\n\n        /*<div>\n            <p><b>Name: </b>{ this.state.user['name'] }</p>\n            <p><b>Poll score: </b>{ this.state.user['score'] }</p>\n            <p><b>Country/Location: </b></p>\n            <p><b>Bio: </b></p>\n\n            <p>Edit your page:</p>\n            <form action='/action' method='POST'>\n            <input type=\"text\" name=\"bio\" placeholder=\"Bio...\" />\n            <input type=\"text\" name=\"location\" placeholder=\"Location...\" />\n            <button type='submit'>Create</button>\n            </form>\n          \n        </div>*/\n    );\n  }\n\n  render() {\n    const { user } = this.state;\n    //if (!user) return 'Loading...';\n\n    return (\n        <div>\n            {this.renderUser()}\n        </div>\n    );\n  }\n}\n  \nexport default ProfilePage;","import React, { Component } from 'react';\nimport * as d3 from 'd3'\nimport './InteractiveChart.css';\nimport { clamp, getAllDataPoints, getDataPointsFromPath, reformatData, reformatPredData, getMostRecentPrediction, getLastDate, getLastValue } from '../../utils/data';\nimport { elementType } from 'prop-types';\nimport { addDays, formatDate } from '../../utils/date';\nimport { timeDay } from 'd3';\n\n\nclass InteractiveChart extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { category: \"us_daily_deaths\", predictionData: null};\n        this.chartRef = React.createRef();\n    }\n    componentDidMount() {\n        const loginStatus = this.props.loginStatus;\n        if (loginStatus['logged in']) {\n            this.renderChart();\n        }\n        else {\n            this.renderChartUnregistered()\n        }\n    }\n\n    //move to utils\n    savePrediction(data, category) {\n        fetch('/update/',{\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\"data\": data, \"category\": category}),\n        });\n    }\n    deletePrediction(category) {\n        fetch('/delete/',{\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\"category\": category}),\n          });\n    }\n\n    createDefaultPrediction(predStartDate, predEndDate) {\n        var defaultData = [];\n        var currDate = predStartDate;\n        //var defined = true;\n        //var value = confirmedData[confirmedData.length - 1].value;\n        \n        //create defaultPredictionData\n        while(+currDate <= +predEndDate) {\n            defaultData.push({date: currDate, value: 0, defined: 0});\n            currDate = d3.timeDay.offset(currDate, 1);\n        }\n        return defaultData;\n    }\n    \n    appendModal() {\n        const signinRedirect = () => {window.location.href='/#/signin'}\n        const signupRedirect = () => {window.location.href='/#/signup'}\n        var modal = document.createElement(\"div\");\n        modal.id = \"modal\";\n        var modalContent = document.createElement(\"div\");\n        modalContent.id = \"modal-content\";\n        var text = document.createElement(\"p\");\n        text.innerText = \"Please log in to save your prediction.\";\n        var signinBtn = document.createElement(\"button\");\n        signinBtn.id = \"signin-btn\";\n        signinBtn.innerText = \"Sign In\";\n        signinBtn.onclick= signinRedirect;\n        signinBtn.className = \"btn primary-btn\";\n        var signupBtn = document.createElement(\"button\");\n        signupBtn.id = \"signup-btn\";\n        signupBtn.onclick= signupRedirect;\n        signupBtn.innerText = \"Sign Up\";\n        signupBtn.className = \"btn primary-btn\";\n\n        modalContent.appendChild(text);\n        modalContent.appendChild(signinBtn);\n        modalContent.appendChild(signupBtn);\n        modal.appendChild(modalContent);\n        this.chartRef.current.appendChild(modal);\n    }\n\n    renderChartUnregistered() {\n        var { forecast, orgs, userPrediction, confirmed, confirmedLastVal, confirmedLastDate, aggregate, mse } = this.props;\n        confirmedLastDate = d3.timeParse(\"%Y-%m-%d\")(confirmedLastDate);\n        // sort models by increasing error\n        var orgIndices = {};\n        for (var i = 0; i < orgs.length; i++) {\n            orgIndices[orgs[i]] = [i];\n        }\n        var sortable = [];\n        for (var err in mse) {\n            sortable.push([err, mse[err]]);\n        }\n        sortable.sort(function(a, b) {\n            return a[1] - b[1];\n        });\n        var sortedOrgs = [];\n        for (var j = 0; j < sortable.length; j++) {\n            sortedOrgs.push(sortable[j][0]); // + \" (MSE=\" + sortable[j][1].toFixed(2).toString() + \")\")\n            orgIndices[sortable[j][0]].push(j);\n        }\n\n        // correct order of forecasts\n        orgIndices = Object.values(orgIndices);\n        var tempForecast = new Array(forecast.length);\n        for (var k = 0; k < orgIndices.length; k++) {\n            tempForecast[orgIndices[k][1]] = forecast[orgIndices[k][0]];\n        }\n\n        // replace orgs and forecasts with new orders\n        orgs = sortedOrgs;\n        forecast = tempForecast;\n\n\n        var predictionData = [];//where we will store formatted userPrediction\n        const createDefaultPrediction = this.createDefaultPrediction;\n        this.appendModal();\n        const category = this.state.category;\n        var compiledData = [];\n        //set up margin, width, height of chart\n        const legendWidth = 380;\n        const toolTipHeight = 50; //to make sure there's room for the tooltip when the value is 0\n        const focusHeight = 100;\n        var margin = {top: 20, right: 30, bottom: 20, left: 60},\n            width = 800 - margin.left - margin.right,\n            height = 400 - margin.top - margin.bottom;\n        var svg = d3.select(\".main-chart\")\n                    // .append(\"svg\")\n                    //     .attr(\"class\", \"main-chart\")\n                        // .attr(\"viewBox\", `0 0 ${width} ${height}`)\n                        .attr(\"viewBox\", `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom + focusHeight + 100}`)\n                        // .attr(\"width\", width)\n                        // .attr(\"height\", height)\n                    .append(\"g\")\n                    .attr(\"transform\", `translate(${margin.left}, ${margin.top + 20} )`);\n        \n                    // add title\n        svg.append(\"text\")\n            .attr(\"x\", (width / 2))             \n            .attr(\"y\", -20)\n            .attr(\"text-anchor\", \"middle\")  \n            .style(\"font-size\", \"16px\") \n            .style(\"text-decoration\", \"underline\")  \n            .style(\"font-weight\", \"bold\")\n            .text(\"COVID-19 Forecasts of Daily Deaths in the US Over Time\");\n\n        const w = 710 - margin.left - margin.right;\n        const h = 360 - margin.top - margin.bottom;\n            \n        //Create X axis label   \n        svg.append(\"text\")\n            .attr(\"x\", w/2 + margin.right)\n            .attr(\"y\", h + 4*margin.bottom)\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Date\");\n            \n        //Create Y axis label\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0-margin.left)\n            .attr(\"x\",0 - (h / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Daily Deaths\");\n        \n        //format confirmedData, forecastData, and predictionData into a list of js objects, convert date from string to js date object\n        var confirmedData = reformatData(confirmed)\n        if (+getLastDate(confirmedData) != +confirmedLastDate) {\n            confirmedData.push({\n                date: confirmedLastDate,\n                value: confirmedLastVal\n            })\n        }\n        else {\n            confirmedLastVal = getLastValue(confirmedData);\n        }\n        var forecastData = forecast.map(f => {\n            return reformatData(f);\n        });\n\n        var aggregateData = reformatData(aggregate);\n        //set other dates\n        const confirmedStartDate = confirmedData[4].date;\n        const predStartDate = confirmedData[confirmedData.length - 1].date; //last date of confirmedData\n        const predLength = 155;\n        const predEndDate = d3.timeDay.offset(predStartDate, predLength)\n        \n        //get confirmedData starting from confirmedStartDate\n        confirmedData = confirmedData.filter(d => +d.date >= +confirmedStartDate);\n\n        //draw x-axis     \n        var x = d3.scaleTime()\n            .domain([confirmedStartDate, predEndDate])\n            .range([ 0, width ])\n            //.nice(); //rounds up/down the max and mind of x axis\n        var xAxis = svg\n                        .append(\"g\")\n                        .attr(\"transform\", \"translate(0,\" + height + \")\")\n                        .call(d3.axisBottom(x));\n        \n        //find max val in confirmedData and forecastData to determine the max of y-axis\n        var confirmedMax = d3.max(confirmedData, function(d) { return +d.value; });\n        var forecastMax = 0;\n        forecastData.map(f => {\n            var currMax = d3.max(f, d => {return d.value;})\n            forecastMax = currMax > forecastMax ? currMax : forecastMax;\n        })\n        var yAxisMax = Math.max(confirmedMax, forecastMax);\n        //draw y-axis\n        var y = d3.scaleLinear()\n            .domain([0, yAxisMax])\n            .range([ height, 0 ])\n            .nice();\n        svg\n            .append(\"g\")\n            .call(d3.axisLeft(y));\n   \n        //list of data displayed in graph - for legend\n        //var legendString = orgs.concat([\"Daily Confirmed Deaths\", \"Aggregate Forecast\", \"User Prediction\"]);\n        var legendString = [\"Daily Confirmed Deaths\", \"Aggregate Forecast\", \"User Prediction\"].concat(orgs);\n        var models = [];\n        orgs.map((o, i) => {\n            //var idx = o.indexOf(\"(\");\n            //models.push(o.substring(0, idx - 1));\n            models.push(o);\n        })\n        var names = [\"Daily Confirmed Deaths\", \"Aggregate Forecast\", \"User Prediction\"].concat(models)\n        const modelClassNames = [\"gt\", \"ihme\", \"youyang\", \"columbia\", \"ucla\"];\n        const labels = [\"confirmed\", \"aggregate\", \"prediction\"].concat(modelClassNames);\n        //color function that assigns random colors to each data\n        var color = d3\n                        .scaleOrdinal()\n                        .domain(models)\n                        .range(d3.schemeTableau10);\n\n         //draw legend\n        var legend = d3.select(\".legend-container\")\n                        .attr(\"viewBox\", \"0 0 400 500\")\n                        .append('g')\n                        .attr(\"id\", \"legend\")\n        var size = 10;\n        const legendMarginL = 30;\n        legend.selectAll(\"rect\")\n            .data(names)\n            .enter()\n            .append(\"circle\")\n                .attr('cx', 10)\n                .attr(\"cy\", function(d,i){ return 20 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                .attr(\"r\", 6)\n                //.attr(\"width\", size)\n                //.attr(\"height\", size)\n                .style(\"fill\", (function(d){ return color(d)}))\n\n        \n        legend.selectAll(\"labels\")\n            .data(legendString)\n            .enter()\n            .append(\"text\")\n                .attr(\"x\", 30)\n                .attr(\"y\", function(d,i){ return 20 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                // .style(\"fill\", function(d, index){ return color(names[index])})\n                .text(function(d){console.log(\"D TEXT\"); console.log(d); return d})\n                    .attr(\"text-anchor\", \"left\")\n                    .style(\"alignment-baseline\", \"middle\")\n\n        //create line generator for confirmed/forecast data and prediction data\n        var lineGenerator = d3.line()\n            //.curve(d3.curveBasis);\n            .curve(d3.curveCatmullRom)//curve that goes through all data points\n        var predLineGenerator = d3.line()\n            .curve(d3.curveBasis); //curve doesn't go through all data points (it's smoothed out)\n            //d3.curveMonotoneX\n            //d3.curveBasis\n            //d3.curveCardinal\n        \n        //function that draws curve\n        var line = lineGenerator\n            .x(function(d) { return x(d.date) })\n            .y(function(d) { return y(d.value) })\n        \n        //area where the confirmed curve will be drawn\n        var mainClip = svg\n                            .append(\"defs\")\n                            .append(\"svg:clipPath\")\n                                .attr(\"id\", \"main-clip\")\n                                .append(\"svg:rect\")\n                                    .attr(\"width\", width )\n                                    .attr(\"height\", height )\n                                    .attr(\"x\", 0)\n                                    .attr(\"y\", 0);\n\n        // Create the confirmed area variable\n        const mainArea = svg\n                                .append('g')\n                                .attr(\"clip-path\", \"url(#main-clip)\");\n\n        //display confirmed data\n        var confirmedLine = mainArea.append(\"path\")\n                                    .attr(\"id\", \"confirmed\")\n                                    .attr(\"class\", \"line\")    \n                                    .datum(confirmedData)    \n                                    .attr('d', line)\n                                    .attr(\"stroke\", color(names[0]))\n                                    .style(\"stroke-width\", \"3px\")\n        var confirmedAreaEndX = x(confirmedData[confirmedData.length - 1].date);\n        var confirmedAreaEndY = y(confirmedData[confirmedData.length - 1].value);\n\n        //append clip-path for prediction curve\n        var predictionClip = svg.append(\"defs\").append(\"svg:clipPath\")\n                                .attr(\"id\", \"prediction-clip\")\n                                .append(\"svg:rect\")\n                                    .attr(\"width\", width - confirmedAreaEndX )\n                                    .attr(\"height\", height )\n                                    .attr(\"x\", confirmedAreaEndX)\n                                    .attr(\"y\", 0);\n        const predictionArea = svg.append('g')\n                            .attr(\"clip-path\", \"url(#prediction-clip)\");\n        \n        //make sure aggregateData curve stems from confiremData curve\n        var idxOfStartDate = d3.bisector(f => f.date).left(aggregateData, predStartDate);\n        //check if predStartDate exists in AD\n        if (aggregateData.length > 0 && +aggregateData[idxOfStartDate].date === +predStartDate) {\n            aggregateData[idxOfStartDate].value = confirmedData[confirmedData.length - 1].value;\n        }\n        else {\n            aggregateData.splice(idxOfStartDate, 0, {\n                date: predStartDate,\n                value: confirmedData[confirmedData.length - 1].value\n            });\n        }\n        aggregateData = aggregateData.splice(idxOfStartDate, aggregateData.length);\n\n\n        //display aggregate data\n        var aggregateLine = predictionArea.append(\"path\")\n                                    .attr(\"id\", \"aggregate\")\n                                    .attr(\"class\", \"line\")        \n                                    .datum(aggregateData)    \n                                    .attr('d', line)\n                                    .attr(\"stroke\", color(names[1]))\n                                    .style(\"stroke-width\", \"2px\")\n        \n        //function that generates the prediction curve\n        var predLine = predLineGenerator\n            .defined(d => d.defined)\n            .x(function(d) { return x(d.date) })\n            .y(function(d) { return y(d.value) })\n\n        //append path for prediction data\n        var yourLine = predictionArea\n                                        .append(\"path\")\n                                        .attr(\"id\", \"your-line\")\n                                        .attr(\"class\", \"prediction line\");\n\n        //display forecast data\n        forecastData.map((f, index) => {\n            //make sure they all stem from the confirmed curve!\n            //var temp = d3.timeParse(\"%Y-%m-%d\")(\"2020-07-18\")\n            var idxOfStartDate = d3.bisector(f => f.date).left(f, predStartDate);\n            //check if predStartDate exists in f\n            if (f.length > 0 && +f[idxOfStartDate].date === +predStartDate) {\n                f[idxOfStartDate].value = confirmedData[confirmedData.length - 1].value;\n            }\n            else {//add data point to forecastData array\n                f.splice(idxOfStartDate, 0, {\n                    date: predStartDate,\n                    value: confirmedData[confirmedData.length - 1].value\n                });\n                f = f.slice(idxOfStartDate, f.length);\n            }\n            forecastData[index] = f;\n            predictionArea.append(\"path\")\n                        .attr(\"class\", \"forecast line\")\n                        .attr(\"id\", modelClassNames[index])\n                        .style(\"stroke\", color(models[index]))\n                        .datum(f)\n                            .attr(\"d\", line);\n        })\n        \n        var lines = document.getElementsByClassName('line');\n        \n        \n        //variables used to initialize user prediction data if it doesn't exist in the db\n        var currDate = predStartDate;\n        var defined = true;\n        var value = confirmedData[confirmedData.length - 1].value;\n        //const confirmedLastVal = value; //used to make sure the first data point of prediction stays the same\n        \n\n        predictionData = createDefaultPrediction(predStartDate, predEndDate);\n        predictionData[0].value = confirmedLastVal;\n        predictionData[0].defined = true;        \n\n        var filteredData = null;\n        //var totalData = confirmedData.concat(predictionData);\n\n//!!    //add forecast data to compiledData\n        const forecastPaths = document.querySelectorAll(\".forecast\");\n        const confirmedPath = document.querySelector(\"#confirmed\");\n        const aggregatePath = document.querySelector(\"#aggregate\");\n\n        confirmedData = getAllDataPoints(confirmedPath, x, y, confirmedStartDate, predStartDate);\n        compiledData.push({\n            name: labels[0],\n            data: confirmedData\n        })\n        var lastDate = aggregateData[aggregateData.length - 1].date;\n        aggregateData = getAllDataPoints(aggregatePath, x, y, aggregateData[0].date, lastDate)\n        compiledData.push({\n            name: labels[1],\n            data: aggregateData\n        })\n        compiledData.push({\n            name: labels[2],\n            data: predictionData\n        })\n        modelClassNames.map((m, index) => {\n            var lastDate = forecastData[index][forecastData[index].length - 1].date;\n            forecastData[index] = getAllDataPoints(forecastPaths[index], x, y, predStartDate, lastDate);\n            compiledData.push({\n                name: m,\n                data: forecastData[index]\n            })\n        })\n\n        //join data to yourLine\n        filteredData = predictionData.filter(predLine.defined())\n        yourLine.datum(filteredData)\n                .attr('d', predLine)\n                .style(\"stroke\", color(names[2]))\n                .style(\"stroke-width\", \"2px\")\n\n        //append new rect  \n        const mouseArea = svg.append(\"rect\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .attr(\"fill\", \"none\")\n            .attr(\"id\", \"mouse-area\")\n            .style(\"pointer-events\",\"visible\");\n\n        //append click area rect\n        var confirmedAreaWidth = confirmedLine.node().getBoundingClientRect().width; //get width of path element containing confirmed data\n        var clickAreaWidth = width - confirmedAreaWidth; //the remaining area\n        /*svg.append(\"rect\")\n           .attr(\"id\", \"click-area\")\n           .attr(\"width\", clickAreaWidth)\n           .attr(\"height\",height)\n           .attr(\"transform\", \"translate (\" + confirmedAreaWidth+\" 0)\")\n           .attr(\"fill\", \"none\")\n           .style(\"pointer-events\",\"visible\");*/\n        //var clickArea = d3.select(\"#click-area\");\n        \n        //append draw your guess text\n        const drawingInstruction = svg\n                                        .append(\"g\")\n                                        .attr(\"id\", \"drawing-instruction\")\n                                        .style(\"opacity\", \"1\");\n        drawingInstruction\n                            .append(\"text\")\n                            .attr(\"id\", \"draw-guess\")\n                            .attr(\"x\", confirmedAreaEndX + (width - confirmedAreaEndX) / 2)             \n                            .attr(\"y\", height - 100)\n                            .attr(\"text-anchor\", \"middle\")  \n                            .text(\"Draw your guess\")\n                            .style(\"font-size\", \"16px\");\n        //append circle at the end of confirmed curve\n        var selectCircle = drawingInstruction\n                                                .append(\"g\")\n                                                .attr(\"id\", \"pointer\");\n        var pointerCircles = [\"pulse-disk\", \"pulse-circle\", \"pulse-circle-2\"];\n        pointerCircles.map((c) => {\n        selectCircle.append(\"circle\")\n            .attr(\"class\", c)\n            .attr(\"cx\", confirmedAreaEndX)\n            .attr(\"cy\", confirmedAreaEndY)\n        })\n\n        var drag = d3.drag()\n                     .on(\"drag\", function() {\n                        //hide \"draw your guess\" text\n                        svg\n                            .select(\"#drawing-instruction\")\n                            .style(\"opacity\", \"0\");\n                        d3.select(\"#tooltip-line\")\n                            .style(\"opacity\", \"0\");\n                        d3.selectAll(\".mouse-per-line circle\")\n                            .style(\"opacity\", \"0\");\n                        d3.select(\".tooltip-box\")\n                            .style(\"display\", \"none\")\n                        var pos = d3.mouse(this);\n                        var date = clamp(predStartDate, predEndDate, x.invert(pos[0]));\n                        var value = clamp(0, yAxisMax, y.invert(pos[1]));\n                        \n                        predictionData.forEach(function(d){\n                            if (+d3.timeDay.round(d.date) === +d3.timeDay.round(date)){\n                                d.value = value;\n                                d.defined = true\n                            }\n                        predictionData[0].value = confirmedLastVal;//make sure the prediction curve is always connected to the confirmed curve\n                        //update totalData everytime predictionData is updated\n                        compiledData[2].data = predictionData;\n                        //console.log(compiledData)\n                        /*yourLine.datum(predictionData)\n                                .attr('d', predLine)*/\n                        filteredData = predictionData.filter(predLine.defined())\n\n                        yourLine.datum(filteredData)\n                                .attr('d', predLine)\n                                // .style(\"stroke\", color(legendString[2]))\n                                // .style(\"stroke-width\", \"2px\")\n                        focusPredCurve.datum(filteredData)\n                                        .attr(\"d\", focusPredLine);\n\n                        });\n                    })\n                    .on(\"end\", function () {\n                        var lastPredDate = filteredData[filteredData.length - 1].date;\n                        getDataPointsFromPath(predictionData, yourLine.node(), x, y, lastPredDate);\n                        compiledData[2].data = predictionData;\n                        d3\n                            .select(\"#modal\")\n                            .style(\"display\", \"block\");\n                        d3.select(\"#tooltip-line\")\n                            .style(\"opacity\", \"1\");\n                        d3.selectAll(\".mouse-per-line circle\")\n                            .style(\"opacity\", \"1\");\n                        d3.select(\".tooltip-box\")\n                            .style(\"display\", \"block\")\n                    });\n        \n        svg.call(drag)\n        var modal = document.getElementById(\"modal\");\n\n        window.onclick = function(event) {\n            if (event.target === modal) {\n              modal.style.display = \"none\";\n            }\n          }\n\n        //finds the datapoint closest to the mouse (along x)\n        /*var bisect = () => {\n            const bisectDate = d3.bisector(d => d.date).left;\n            return mx => {\n                const date = x.invert(mx);\n                const index = bisectDate(totalData, date, 1);\n                const a = totalData[index - 1];\n                const b = totalData[index];\n                return b && (date - a.date > b.date - date) ? b : a;\n            };\n        }*/\n\n        console.log(compiledData);\n        const tooltipArea = svg\n        .append(\"g\")\n        .attr(\"class\", \"tooltip\")\n\n        tooltipArea.append(\"path\") //vertical line\n        .attr(\"id\", \"tooltip-line\")\n        .style(\"stroke\", \"black\")\n        .style(\"stroke-width\", \"0.5px\")\n        .style(\"opacity\", \"0\");\n        //where text will be\n        var tooltipBox = d3.select(\".tooltip-box\")\n            //  .style(\"background-color\", \"white\")\n            // .style(\"border\", \"solid\")\n            // .style(\"border-width\", \"2px\")\n            // .style(\"border-radius\", \"5px\")\n            // .style(\"padding\", \"5px\")\n            .style(\"position\", \"absolute\")\n            .style(\"display\", \"block\")\n            .style(\"left\", \"10px\")\n            .style(\"top\", \"10px\");\n        // tooltipBox.selectAll(\"box\")\n        //             .data(compiledData)\n        //             .enter()\n        //             .append(\"div\")\n        //             .attr(\"class\", d => d.name);    \n\n        //console.log(compiledData)\n        var mousePerLine = tooltipArea\n                        .selectAll(\".mouse-per-line\")\n                        .data(compiledData)\n                        .enter()\n                        .append(\"g\")\n                        .attr(\"class\", \"mouse-per-line\");\n\n        mousePerLine.append(\"circle\")\n                    .attr(\"r\", 2)\n                    .style(\"stroke\", function(d, index) {\n                        return color(names[index]);\n                    })\n                    .style(\"fill\", \"none\")\n                    .style(\"stroke-width\", \"1px\")\n                    .style(\"opacity\", \"0\");\n\n        var chart = tooltipArea\n            .append(\"svg:rect\")\n            .attr('width', width)\n            .attr('height', height)\n            .attr('fill', 'none')\n            .attr('pointer-events', 'all')\n            //.style(\"cursor\", \"pointer\")\n            .on('mouseout', function() { // on mouse out hide line, circles and text\n                d3.select(\"#tooltip-line\")\n                .style(\"opacity\", \"0\");\n                d3.selectAll(\".mouse-per-line circle\")\n                .style(\"opacity\", \"0\");\n                d3.selectAll(\".mouse-per-line text\")\n                .style(\"opacity\", \"0\")\n                tooltipBox.style(\"display\", \"none\")\n            })\n            .on('mouseover', function() { // on mouse in show line, circles and text\n                d3.select(\"#tooltip-line\")\n                .style(\"opacity\", \"1\");\n                tooltipBox.style(\"display\", \"block\")\n            })\n            .on('mousemove', function() { // mouse moving over canvas\n                var mouse = d3.mouse(this);\n                var xCoord = mouse[0];\n                var yCoord = mouse[1];\n                const xLowerBoundary = x(confirmedData[confirmedData.length - 1].date)\n                if (xCoord > xLowerBoundary && xCoord < width && yCoord > 0 && yCoord < height) {\n                    chart.attr(\"cursor\", \"pointer\");\n                }\n                else {\n                    chart.attr(\"cursor\", \"default\");\n                }\n                d3\n                    .select(\"#tooltip-line\")\n                    .attr(\"d\", function() {\n                        var d = \"M\" + xCoord + \",\" + height;\n                        d += \" \" + xCoord + \",\" + 0;\n                        return d;\n                    });\n                tooltipBox\n                    .style('left', `${d3.event.pageX + 20}px`)\n                    .style('top', `${d3.event.pageY + 20}px`)\n                d3\n                    .selectAll(\".mouse-per-line\")\n                    .attr(\"transform\", function(d, i) {\n                        if (d.data.length === 0) {return;}\n                        var date = x.invert(xCoord);\n                        var value = -1;\n                        d.data.map(d => {\n                            if(+d.date === +d3.timeDay.round(date) && d.defined !== 0) {\n                                value = d.value;\n                            }\n                        })\n                        var element = d3.select(this);\n                        var textBox = tooltipBox.select(`.${d.name}`);\n\n                        if (value >= 0) {\n                            if(textBox.empty()) {\n                                textBox = tooltipBox.append(\"div\")\n                                                    .attr(\"class\", d.name)\n                                                    .style(\"padding-left\", \"10px\")\n                                                    .style(\"padding-right\", \"10px\")\n                                                    .style(\"background-color\", color(names[i]))\n                                                    .style(\"color\", \"white\");\n\n                            }\n                            else {\n                                textBox.html(`${names[i]}: ${Math.round(value)}`)\n                            }\n                            element.select(\"circle\")\n                                    .style(\"opacity\", \"1\");\n                            return \"translate(\" + mouse[0] + \",\" + y(value)+\")\";\n                        }\n                        else {\n                            if(!textBox.empty()) {\n                                textBox.remove();\n                            }\n                            element\n                                    .select(\"circle\")\n                                    .style(\"opacity\", \"0\");\n                        }\n                        \n                });\n            })\n        ////ADD TODAY LINE/////////////////////////////////////////////////////\n        const today = d3.timeParse(\"%Y-%m-%d\")(new Date().toISOString().substring(0,10));\n        var todayMarker = svg\n                            .append(\"g\")\n                            .attr(\"id\", \"today-marker\")\n        todayMarker\n                    .append(\"line\")\n                    .attr(\"id\", \"today-line\")\n                    .attr(\"x1\", x(today))\n                    .attr(\"x2\", x(today))\n                    .attr(\"y1\", 0)\n                    .attr(\"y2\", height)\n                    .attr(\"stroke\", \"black\")\n                    .attr(\"stroke-width\", 1)\n                    .attr(\"stroke-dasharray\", \"8, 8\")\n        todayMarker\n                    .append(\"text\")\n                    .attr(\"id\", \"today-text\")\n                    .attr(\"transform\", `translate(${x(today) + 17}, 0) rotate(-90)`)\n                    .text(\"Today\")\n                    .style(\"text-anchor\", \"end\")\n        /////////////////////////////////////////////////////////////////////////////////////////////\n        const focusMargin = 50;\n        var focus = svg\n                            .append(\"g\")\n                                .attr(\"viewBox\", [0, 0, width, focusHeight])\n                                .attr(\"transform\", `translate(0,${height + focusMargin} )`)\n                                //.attr(\"width\", width + 100)\n                                //.attr(\"height\", height)\n                                .style(\"display\", \"block\")\n \n        var focusX = d3\n                            .scaleTime()\n                            .domain([confirmedStartDate, predEndDate])\n                            .range([0, width]);\n        const focusY = d3\n                        .scaleLinear()\n                        .domain([0, yAxisMax])\n                        .range([focusHeight - margin.bottom, 0])\n                        .nice();\n        \n        var focusXAxis = focus\n                                    .append(\"g\")\n                                    .attr(\"transform\", `translate(0,${focusHeight - margin.bottom})`)\n                                    .call(d3.axisBottom(focusX));\n        const brush = d3.brushX()\n                        .extent([[0, 0], [width, focusHeight - margin.bottom]])\n                        .on(\"brush\", brushed)\n                        .on(\"end\", brushended);\n\n        const defaultSelection = [x(d3.timeMonth.offset(x.domain()[1], -8)), x.range()[1]];\n    \n        /*context.append(\"g\")\n                .call(xAxis, x, focusHeight);*/\n        const focusLine = d3.line()\n                            .curve(d3.curveCatmullRom)\n                            .x(function(d) {return x(d.date)})\n                            .y(function (d) {return focusY(d.value)})\n        \n        const focusPredLine = d3.line()\n                                .curve(d3.curveBasis)\n                                .defined(d => d.defined)\n                                .x(function(d) { return focusX(d.date) })\n                                .y(function(d) { return focusY(d.value) })        \n        focus.append(\"path\")\n            .datum(confirmedData)\n            .attr(\"d\", focusLine)\n            .attr(\"class\", \"context-curve\")\n            .attr(\"stroke\", color(names[0]))\n        \n        focus.append(\"path\")\n            .datum(aggregateData)\n            .attr(\"d\", focusLine)\n            .attr(\"class\", \"context-curve\")\n            .attr(\"stroke\", color(names[1]))\n\n        var focusPredCurve = focus.append(\"path\")\n                                    .datum(predictionData)\n                                    .attr(\"d\", focusPredLine)\n                                    .attr(\"class\", \"context-curve\")\n                                    .attr(\"stroke\", color(names[2]))\n        \n        forecastData.map((f, index) => {\n            focus\n                    .append(\"path\")\n                    .datum(f)\n                    .attr(\"d\", focusLine)\n                    .attr(\"class\", \"context-curve\")\n                    .attr(\"stroke\", color(models[index]));\n\n        })\n        function brushed() {\n            if (d3.event.selection) {\n                var extent = d3.event.selection;\n                //console.log([ contextX.invert(extent[0]), contextX.invert(extent[1]) ]);\n                x.domain([ focusX.invert(extent[0]), focusX.invert(extent[1]) ]);\n                xAxis\n                        //.transition()\n                        //.duration(1000)\n                        .call(d3.axisBottom(x))\n                var newX = x(confirmedData[confirmedData.length - 1].date);\n                newX = newX < 0 ? 0 : newX;\n                d3\n                    .select(\"#prediction-clip\")\n                    .select(\"rect\")\n                        .attr(\"width\", width - newX)\n                        .attr(\"x\", newX);\n\n                svg\n                    .selectAll(\".line\")\n                    //.transition()\n                    //.duration(1000)\n                    .attr('d', line)\n\n                svg\n                    .select(\"#your-line\")\n                    .attr(\"d\", predLine)\n                \n                //reposition draw your guess text and pointer\n                svg\n                    .select(\"#draw-guess\")\n                    .attr(\"x\", newX + (width - newX) / 2);\n                svg\n                    .select(\"#pointer\")\n                    .selectAll(\"circle\")\n                        .attr(\"cx\", newX);\n                todayMarker.select(\"line\")\n                        .attr(\"x1\", x(today))\n                        .attr(\"x2\", x(today))\n                todayMarker.select(\"text\")\n                        .attr(\"transform\", `translate(${x(today) + 17}, 0) rotate(-90)`)\n\n            }\n        }\n        \n        function brushended() {\n            if (!d3.event.selection) {\n                gb.call(brush.move, defaultSelection);\n            }\n\n        }\n        const gb = focus\n                        .call(brush)\n                        .call(brush.move, defaultSelection)\n                        .on(\"click\", function() {\n                            d3.select(\".speech-bubble\").style(\"display\", \"none\");\n                        })\n        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n        var deleteButton = d3.select(\"#delete-btn\").node()\n        deleteButton.onclick = () => {\n            predictionData = createDefaultPrediction(predStartDate, predEndDate);\n            predictionData[0].value = confirmedLastVal;\n            predictionData[0].defined = true;\n            //update yourLine\n            var filtered = predictionData.filter(predLine.defined())\n            yourLine.datum(filtered)\n                    .attr('d', predLine)\n            focusPredCurve.datum(filtered)\n                            .attr(\"d\", focusPredLine)\n                    \n            svg\n                .select(\"#drawing-instruction\")\n                .style(\"opacity\", \"1\");\n            compiledData[2].data = predictionData;\n        };\n        ///////////////////////////////////////////////////////////////// \n        var legendElement = document.querySelector(\"#legend\");\n        const legendCompleteWidth = legendElement.getBoundingClientRect().width;\n        const legendSingleHeight = 25;\n        var legendConfirmed = legend.append(\"rect\")\n        .attr(\"width\", legendCompleteWidth)\n        .attr(\"height\", legendSingleHeight)\n        .attr(\"x\", 0)\n        .attr(\"y\", 10)\n        .attr(\"fill\", \"none\")\n        .style(\"pointer-events\",\"visible\");\n\n        var legendAggregate = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendPrediction = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 2)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendGeorgiaTech = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 3)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendIhme = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 4)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendYouyang = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 5)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendColumbia = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 6)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendUcla = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 7)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n        \n        // var resetBtn = legend.append(\"rect\")\n        //         .attr(\"class\", \"reset-btn\")\n        //         .attr(\"width\", 100)\n        //         .attr(\"height\", 40)\n        //         .attr(\"x\", 0)\n        //         .attr(\"y\", 30 + legendSingleHeight * 8)\n        //         .attr(\"fill\", \"red\")\n        //         .style(\"pointer-events\",\"visible\")\n        //         .on(\"click\", function(){\n        //             predictionData = createDefaultPrediction(predStartDate, predEndDate);\n        //             predictionData[0].value = confirmedLastVal;\n        //             predictionData[0].defined = true;\n        //             //update yourLine\n        //             var filtered = predictionData.filter(predLine.defined())\n        //             yourLine.datum(filtered)\n        //                     .attr('d', predLine)\n        //             focusPredCurve.datum(filtered)\n        //                             .attr(\"d\", focusPredLine)\n                            \n        //             svg\n        //                 .select(\"#drawing-instruction\")\n        //                 .style(\"opacity\", \"1\");\n        //             compiledData[2].data = predictionData;\n        //         });\n        // var resetText = legend.append(\"text\")\n        //                         .text(\"hello\")\n        //                         .attr(\"fill\", \"black\")\n        //                         .attr(\"position\", \"absolute\")\n        //                         .attr(\"x\", 0)\n        //                         .attr(\"y\", 0)\n        // resetBtn.node().innerHTML = \"  <text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle'>TEXT</text>\"\n                \n        legendConfirmed.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#confirmed\").style(\"stroke\", color(names[0]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendAggregate.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#aggregate\").style(\"stroke\", color(names[1]));\n                         })\n                         .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendPrediction.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#your-line\").style(\"stroke\", color(names[2]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendGeorgiaTech.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#gt\").style(\"stroke\", color(names[3]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendIhme.on(\"mouseover\", function() {\n                        svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                        svg.select(\"#ihme\").style(\"stroke\", color(names[4]));\n                    })\n                    .on(\"mouseout\", function() {\n                        svg.selectAll(\".line\")\n                            .style(\"stroke\", (d, i) => color(names[i]))\n                    })\n        legendYouyang.on(\"mouseover\", function() {\n                        svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                        svg.select(\"#youyang\").style(\"stroke\", color(names[5]));\n                    })\n                    .on(\"mouseout\", function() {\n                        svg.selectAll(\".line\")\n                            .style(\"stroke\", (d, i) => color(names[i]))\n                    })\n        legendColumbia.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#columbia\").style(\"stroke\", color(names[6]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendUcla.on(\"mouseover\", function() {\n                        svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                        svg.select(\"#ucla\").style(\"stroke\", color(names[7]));\n                    })\n                    .on(\"mouseout\", function() {\n                        svg.selectAll(\".line\")\n                            .style(\"stroke\", (d, i) => color(names[i]))\n                    })\n        \n    }\n\n    renderChart() {\n        var { forecast, orgs, userPrediction, confirmed, confirmedLastVal, confirmedLastDate, aggregate, mse } = this.props;\n        confirmedLastDate = d3.timeParse(\"%Y-%m-%d\")(confirmedLastDate);\n        // sort models by increasing error\n        var orgIndices = {};\n        for (var i = 0; i < orgs.length; i++) {\n            orgIndices[orgs[i]] = [i];\n        }\n        var sortable = [];\n        for (var err in mse) {\n            sortable.push([err, mse[err]]);\n        }\n        sortable.sort(function(a, b) {\n            return a[1] - b[1];\n        });\n        var sortedOrgs = [];\n        for (var j = 0; j < sortable.length; j++) {\n            sortedOrgs.push(sortable[j][0]); // + \" (MSE=\" + sortable[j][1].toFixed(2).toString() + \")\")\n            orgIndices[sortable[j][0]].push(j);\n        }\n\n        // correct order of forecasts\n        orgIndices = Object.values(orgIndices);\n        var tempForecast = new Array(forecast.length);\n        for (var k = 0; k < orgIndices.length; k++) {\n            tempForecast[orgIndices[k][1]] = forecast[orgIndices[k][0]];\n        }\n\n        // replace orgs and forecasts with new orders\n        orgs = sortedOrgs;\n        forecast = tempForecast;\n\n        var predictionData = [];//where we will store formatted userPrediction\n        var defaultPredictionData = []\n        const savePrediction = this.savePrediction;\n        const createDefaultPrediction = this.createDefaultPrediction;\n        const category = this.state.category;\n        var compiledData = [];\n        //set up margin, width, height of chart\n        const legendWidth = 230;\n        const toolTipHeight = 50; //to make sure there's room for the tooltip when the value is 0\n        const focusHeight = 100;\n        const titleHeight = 20;\n        var margin = {top: 20, right: 30, bottom: 20, left: 60},\n            width = 800 - margin.left - margin.right,\n            height = 400 - margin.top - margin.bottom;\n        var svg = d3.select(\".main-chart\")\n            // .append(\"svg\")\n                // .attr(\"class\", \"main-chart\")\n                // .attr(\"viewBox\", `0 0 ${width} ${height}`)\n                .attr(\"viewBox\", `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom + focusHeight + 100}`)\n                // .attr(\"width\", width)\n                // .attr(\"height\", height)\n            .append(\"g\")\n            .attr(\"transform\", `translate(${margin.left}, ${margin.top + 20} )`);\n\n        // add title\n        svg.append(\"text\")\n            .attr(\"x\", (width / 2))             \n            .attr(\"y\", -20)\n            .attr(\"text-anchor\", \"middle\")  \n            .style(\"font-size\", \"16px\") \n            .style(\"text-decoration\", \"underline\")  \n            .style(\"font-weight\", \"bold\")\n            .text(\"COVID-19 Forecasts of Daily Deaths in the US Over Time\");\n\n        const w = 710 - margin.left - margin.right;\n        const h = 360 - margin.top - margin.bottom;\n            \n        //Create X axis label   \n        svg.append(\"text\")\n            .attr(\"x\", w/2 + margin.right)\n            .attr(\"y\", h + 4*margin.bottom)\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Date\");\n            \n        //Create Y axis label\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - margin.left)\n            .attr(\"x\", 0 - (h/2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .text(\"Daily Deaths\");\n        \n        //format confirmedData, forecastData, and predictionData into a list of js objects, convert date from string to js date object\n        var confirmedData = reformatData(confirmed);\n        if (+getLastDate(confirmedData) != +confirmedLastDate) {\n            confirmedData.push({\n                date: confirmedLastDate,\n                value: confirmedLastVal\n            })\n        }\n        else {\n            confirmedLastVal = getLastValue(confirmedData);\n        }\n        \n        var forecastData = forecast.map(f => {\n            return reformatData(f);\n        });\n        var aggregateData = reformatData(aggregate);\n\n        //store userPrediction in predictionData if it exists\n        if(Object.keys(userPrediction).length > 0) {\n            const mostRecentPred = getMostRecentPrediction(userPrediction);\n            predictionData = reformatPredData(mostRecentPred);\n        }\n  \n        //set other dates\n        const confirmedStartDate = confirmedData[4].date;\n        const predStartDate = confirmedLastDate; //last date of confirmedData\n        const predLength = 155;\n        const predEndDate = d3.timeDay.offset(predStartDate, predLength)\n        \n        //get confirmedData starting from confirmedStartDate\n        confirmedData = confirmedData.filter(d => +d.date >= +confirmedStartDate);\n\n        //draw x-axis     \n        var x = d3.scaleTime()\n            .domain([confirmedStartDate, predEndDate])\n            .range([ 0, width ])\n            //.nice(); //rounds up/down the max and mind of x axis\n        var xAxis = svg\n                        .append(\"g\")\n                        .attr(\"transform\", \"translate(0,\" + height + \")\")\n                        .call(d3.axisBottom(x));\n        \n        //find max val in confirmedData and forecastData to determine the max of y-axis\n        var confirmedMax = d3.max(confirmedData, function(d) { return +d.value; });\n        var forecastMax = 0;\n        forecastData.map(f => {\n            var currMax = d3.max(f, d => {return d.value;})\n            forecastMax = currMax > forecastMax ? currMax : forecastMax;\n        })\n        var yAxisMax = Math.max(confirmedMax, forecastMax);\n        //draw y-axis\n        var y = d3.scaleLinear()\n            .domain([0, yAxisMax])\n            .range([ height, 0 ])\n            .nice();\n        svg\n            .append(\"g\")\n            .call(d3.axisLeft(y));\n   \n        //list of data displayed in graph - for legend\n        //var legendString = orgs.concat([\"Daily Confirmed Deaths\", \"Aggregate Forecast\", \"User Prediction\"]);\n        var legendString = [\"Daily Confirmed Deaths\", \"Aggregate Forecast\", \"User Prediction\"].concat(orgs);\n        var models = [];\n        orgs.map((o, i) => {\n            //var idx = o.indexOf(\"(\");\n            //models.push(o.substring(0, idx - 1));\n            models.push(o);\n        })\n        var names = [\"Daily Confirmed Deaths\", \"Aggregate Forecast\", \"User Prediction\"].concat(models)\n        const modelClassNames = [\"gt\", \"ihme\", \"youyang\", \"columbia\", \"ucla\"];\n        const labels = [\"confirmed\", \"aggregate\", \"prediction\"].concat(modelClassNames);\n        //color function that assigns random colors to each data\n        var color = d3\n                        .scaleOrdinal()\n                        .domain(models)\n                        .range(d3.schemeTableau10);\n\n         //draw legend\n        var legend = d3.select(\".legend-container\")\n                        .attr(\"viewBox\", \"0 0 400 500\")\n                        .append('g')\n                        .attr(\"id\", \"legend\")\n        var size = 10;\n        const legendMarginL = 30;\n        legend.selectAll(\"rect\")\n            .data(names)\n            .enter()\n            .append(\"circle\")\n                .attr('cx', 10)\n                .attr(\"cy\", function(d,i){ return 20 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                .attr(\"r\", 6)\n                //.attr(\"width\", size)\n                //.attr(\"height\", size)\n                .style(\"fill\", (function(d){ return color(d)}))\n\n        \n        legend.selectAll(\"labels\")\n            .data(legendString)\n            .enter()\n            .append(\"text\")\n                .attr(\"x\", 30)\n                .attr(\"y\", function(d,i){ return 20 + i*25}) // 100 is where the first dot appears. 25 is the distance between dots\n                // .style(\"fill\", function(d, index){ return color(names[index])})\n                .text(function(d){console.log(\"D TEXT\"); console.log(d); return d})\n                    .attr(\"text-anchor\", \"left\")\n                    .style(\"alignment-baseline\", \"middle\")\n        var legendElement = document.querySelector(\"#legend\");\n        const legendCompleteWidth = legendElement.getBoundingClientRect().width;\n        const legendSingleHeight = 25;\n        /*var legendArea = legend.append(\"rect\")\n                                .attr(\"width\", legendCompleteWidth)\n                                .attr(\"height\", legendCompleteHeight)\n                                .attr(\"x\", width + 40)\n                                .attr(\"y\", 10)\n                                .attr(\"fill\", \"none\")\n                                .style(\"pointer-events\",\"visible\");*/\n\n        //create line generator for confirmed/forecast data and prediction data\n        var lineGenerator = d3.line()\n            //.curve(d3.curveBasis);\n            .curve(d3.curveCatmullRom)//curve that goes through all data points\n        var predLineGenerator = d3.line()\n            .curve(d3.curveBasis); //curve doesn't go through all data points (it's smoothed out)\n            //d3.curveMonotoneX\n            //d3.curveBasis\n            //d3.curveCardinal\n        \n        //function that draws curve\n        var line = lineGenerator\n            .x(function(d) { return x(d.date) })\n            .y(function(d) { return y(d.value) })\n        \n        //area where the confirmed curve will be drawn\n        var mainClip = svg\n                            .append(\"defs\")\n                            .append(\"svg:clipPath\")\n                                .attr(\"id\", \"main-clip\")\n                                .append(\"svg:rect\")\n                                    .attr(\"width\", width )\n                                    .attr(\"height\", height )\n                                    .attr(\"x\", 0)\n                                    .attr(\"y\", 0);\n\n        // Create the confirmed area variable\n        const mainArea = svg\n                                .append('g')\n                                .attr(\"clip-path\", \"url(#main-clip)\");\n\n        //display confirmed data\n        var confirmedLine = mainArea.append(\"path\")\n                                    .attr(\"id\", \"confirmed\")\n                                    .attr(\"class\", \"line\")    \n                                    .datum(confirmedData)    \n                                    .attr('d', line)\n                                    .attr(\"stroke\", color(names[0]))\n                                    .style(\"stroke-width\", \"3px\")\n        var confirmedAreaEndX = x(confirmedData[confirmedData.length - 1].date);\n        var confirmedAreaEndY = y(confirmedData[confirmedData.length - 1].value);\n\n        //append clip-path for prediction curve\n        var predictionClip = svg.append(\"defs\").append(\"svg:clipPath\")\n                                .attr(\"id\", \"prediction-clip\")\n                                .append(\"svg:rect\")\n                                    .attr(\"id\", \"prediction-rect\")\n                                    .attr(\"width\", width - confirmedAreaEndX )\n                                    .attr(\"height\", height )\n                                    .attr(\"x\", confirmedAreaEndX)\n                                    .attr(\"y\", 0);\n        const predictionArea = svg.append('g')\n                            .attr(\"clip-path\", \"url(#prediction-clip)\");\n        \n        //make sure aggregateData curve stems from confiremData curve\n        var idxOfStartDate = d3.bisector(f => f.date).left(aggregateData, predStartDate);\n        //check if predStartDate exists in AD\n        if (aggregateData.length > 0 && +aggregateData[idxOfStartDate].date === +predStartDate) {\n            aggregateData[idxOfStartDate].value = confirmedData[confirmedData.length - 1].value;\n        }\n        else {\n            aggregateData.splice(idxOfStartDate, 0, {\n                date: predStartDate,\n                value: confirmedData[confirmedData.length - 1].value\n            });\n        }\n        aggregateData = aggregateData.splice(idxOfStartDate, aggregateData.length);\n\n        //display aggregate data\n        var aggregateLine = predictionArea.append(\"path\")\n                                    .attr(\"id\", \"aggregate\")\n                                    .attr(\"class\", \"line\")        \n                                    .datum(aggregateData)    \n                                    .attr('d', line)\n                                    .attr(\"stroke\", color(names[1]))\n                                    .style(\"stroke-width\", \"2px\")\n        //display user prediction\n        //function that generates the prediction curve\n        var predLine = predLineGenerator\n            .defined(d => d.defined)\n            .x(function(d) { return x(d.date) })\n            .y(function(d) { return y(d.value) })\n\n        //append path for prediction data\n        var yourLine = predictionArea\n                                        .append(\"path\")\n                                        .attr(\"id\", \"your-line\")\n                                        .attr(\"class\", \"prediction line\");\n\n        \n        //display forecast data\n        forecastData.map((f, index) => {\n            //make sure they all stem from the confirmed curve!\n            //var temp = d3.timeParse(\"%Y-%m-%d\")(\"2020-07-18\")\n            var idxOfStartDate = d3.bisector(f => f.date).left(f, predStartDate);\n            //check if predStartDate exists in f\n            if (f.length > 0 && +f[idxOfStartDate].date === +predStartDate) {\n                f[idxOfStartDate].value = confirmedData[confirmedData.length - 1].value;\n            }\n            else {//add data point to forecastData array\n                f.splice(idxOfStartDate, 0, {\n                    date: predStartDate,\n                    value: confirmedData[confirmedData.length - 1].value\n                });\n                f = f.slice(idxOfStartDate, f.length);\n            }\n            forecastData[index] = f;\n            predictionArea.append(\"path\")\n                        .attr(\"class\", \"forecast line\")\n                        .attr(\"id\", modelClassNames[index])\n                        .style(\"stroke\", color(models[index]))\n                        .datum(f)\n                            .attr(\"d\", line);\n        })\n        \n        var lines = document.getElementsByClassName('line');        \n        \n        //variables used to initialize user prediction data if it doesn't exist in the db\n        var currDate = predStartDate;\n        var defined = true;\n        var value = confirmedData[confirmedData.length - 1].value;\n        //const confirmedLastVal = value; //used to make sure the first data point of prediction stays the same\n        \n        //check if userPrediction already exists in db\n        if (Object.keys(userPrediction).length > 0) {\n            predictionData = predictionData.filter(d => (+d.date >= +predStartDate) && (+d.date <= +predEndDate));\n            predictionData[0].value = confirmedLastVal;\n            predictionData[0].defined = true;\n            currDate = d3.timeDay.offset(predictionData[predictionData.length - 1].date, 1);\n            predictionData.concat(createDefaultPrediction(currDate, predEndDate));\n        }\n        else {\n            predictionData = createDefaultPrediction(predStartDate, predEndDate);\n            predictionData[0].value = confirmedLastVal;\n            predictionData[0].defined = true;\n        }\n\n        var filteredData = null;\n//!!    //add forecast data to compiledData\n        //get complete dataset from paths\n        const forecastPaths = document.querySelectorAll(\".forecast\");\n        const confirmedPath = document.querySelector(\"#confirmed\");\n        const aggregatePath = document.querySelector(\"#aggregate\");\n        confirmedData = getAllDataPoints(confirmedPath, x, y, confirmedStartDate, predStartDate);\n        compiledData.push({\n            name: labels[0],\n            data: confirmedData\n        })\n        console.log(confirmedData);\n        console.log(confirmed)\n        var lastDate = aggregateData[aggregateData.length - 1].date;\n        aggregateData = getAllDataPoints(aggregatePath, x, y, aggregateData[0].date, lastDate)\n        compiledData.push({\n            name: labels[1],\n            data: aggregateData\n        })\n        compiledData.push({\n            name: labels[2],\n            data: predictionData\n        })\n        modelClassNames.map((m, index) => {\n            var lastDate = forecastData[index][forecastData[index].length - 1].date;\n            forecastData[index] = getAllDataPoints(forecastPaths[index], x, y, predStartDate, lastDate);\n            compiledData.push({\n                name: m,\n                data: forecastData[index]\n            })\n        })\n        //join data to yourLine\n        filteredData = predictionData.filter(predLine.defined())\n        yourLine.datum(filteredData)\n                .attr('d', predLine)\n                .style(\"stroke\", color(names[2]))\n                .style(\"stroke-width\", \"2px\")\n        //append new rect  \n        const mouseArea = svg.append(\"rect\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .attr(\"fill\", \"none\")\n            .attr(\"id\", \"mouse-area\")\n            .style(\"pointer-events\",\"visible\");\n\n        //append click area rect\n        var confirmedAreaWidth = confirmedLine.node().getBoundingClientRect().width; //get width of path element containing confirmed data\n        var clickAreaWidth = width - confirmedAreaWidth; //the remaining area\n        svg.append(\"rect\")\n           .attr(\"id\", \"click-area\")\n           .attr(\"width\", clickAreaWidth)\n           .attr(\"height\",height)\n           .attr(\"transform\", \"translate (\" + confirmedAreaWidth+\" 0)\")\n           .attr(\"fill\", \"none\")\n           .style(\"pointer-events\",\"visible\");\n        //var clickArea = d3.select(\"#click-area\");\n        \n        //append draw your guess text\n        const drawingInstruction = svg\n                                        .append(\"g\")\n                                        .attr(\"id\", \"drawing-instruction\")\n                                        .style(\"opacity\", \"0\");\n        drawingInstruction\n                            .append(\"text\")\n                            .attr(\"id\", \"draw-guess\")\n                            .attr(\"x\", confirmedAreaEndX + (width - confirmedAreaEndX) / 2)             \n                            .attr(\"y\", height - 100)\n                            .attr(\"text-anchor\", \"middle\")  \n                            .text(\"Draw your guess\")\n                            .style(\"font-size\", \"16px\");\n        //append circle at the end of confirmed curve\n        var selectCircle = drawingInstruction\n                                                .append(\"g\")\n                                                .attr(\"id\", \"pointer\");\n        var pointerCircles = [\"pulse-disk\", \"pulse-circle\", \"pulse-circle-2\"];\n        pointerCircles.map((c) => {\n        selectCircle.append(\"circle\")\n            .attr(\"class\", c)\n            .attr(\"cx\", confirmedAreaEndX)\n            .attr(\"cy\", confirmedAreaEndY)\n        })\n\n        if(Object.keys(userPrediction).length === 0) {\n            svg\n                .select(\"#drawing-instruction\")\n                .style(\"opacity\", \"1\");\n        }\n\n        var drag = d3.drag()\n                     .on(\"drag\", function() {\n                        //hide \"draw your guess\" text\n                        svg\n                            .select(\"#drawing-instruction\")\n                            .style(\"opacity\", \"0\");\n                        d3.select(\"#tooltip-line\")\n                            .style(\"opacity\", \"0\");\n                        d3.selectAll(\".mouse-per-line circle\")\n                            .style(\"opacity\", \"0\");\n                        d3.select(\".tooltip-box\")\n                            .style(\"display\", \"none\")\n                        var pos = d3.mouse(this);\n                        var date = clamp(predStartDate, predEndDate, x.invert(pos[0]));\n                        var value = clamp(0, yAxisMax, y.invert(pos[1]));\n                        \n                        predictionData.forEach(function(d){\n                            if (+d3.timeDay.round(d.date) === +d3.timeDay.round(date)){\n                                d.value = value;\n                                d.defined = true\n                            }\n                        predictionData[0].value = confirmedLastVal;//make sure the prediction curve is always connected to the confirmed curve\n                        //update totalData everytime predictionData is updated\n                        compiledData[2].data = predictionData;\n                        //console.log(compiledData)\n                        /*yourLine.datum(predictionData)\n                                .attr('d', predLine)*/\n                        filteredData = predictionData.filter(predLine.defined())\n                        yourLine.datum(filteredData)\n                                .attr('d', predLine)\n                                // .style(\"stroke\", color(models[2]))\n                                // .style(\"stroke-width\", \"2px\")\n                        focusPredCurve.datum(filteredData)\n                                        .attr(\"d\", focusPredLine);\n\n                        });\n                    })\n                    .on(\"end\", function () {\n                        d3.select(\"#tooltip-line\")\n                            .style(\"opacity\", \"1\");\n                        d3.selectAll(\".mouse-per-line circle\")\n                            .style(\"opacity\", \"1\");\n                        d3.select(\".tooltip-box\")\n                            .style(\"display\", \"block\")\n                        var lastPredDate = filteredData[filteredData.length - 1].date;\n                        getDataPointsFromPath(predictionData, yourLine.node(), x, y, lastPredDate);\n                        compiledData[2].data = predictionData;\n                        savePrediction(predictionData, category);\n                    });\n        \n        svg.call(drag)\n\n        const tooltipArea = svg\n                                .append(\"g\")\n                                .attr(\"class\", \"tooltip\")\n\n        tooltipArea.append(\"path\") //vertical line\n                    .attr(\"id\", \"tooltip-line\")\n                    .style(\"stroke\", \"black\")\n                    .style(\"stroke-width\", \"0.5px\")\n                    .style(\"opacity\", \"0\");\n        //where text will be\n        var tooltipBox = d3.select(\".tooltip-box\")\n                            //  .style(\"background-color\", \"white\")\n                            // .style(\"border\", \"solid\")\n                            // .style(\"border-width\", \"2px\")\n                            // .style(\"border-radius\", \"5px\")\n                            // .style(\"padding\", \"5px\")\n                            .style(\"position\", \"absolute\")\n                            .style(\"display\", \"block\")\n                            .style(\"left\", \"10px\")\n                            .style(\"top\", \"10px\");\n        // tooltipBox.selectAll(\"box\")\n        //             .data(compiledData)\n        //             .enter()\n        //             .append(\"div\")\n        //             .attr(\"class\", d => d.name);    \n\n        //console.log(compiledData)\n        var mousePerLine = tooltipArea\n                                        .selectAll(\".mouse-per-line\")\n                                        .data(compiledData)\n                                        .enter()\n                                        .append(\"g\")\n                                        .attr(\"class\", \"mouse-per-line\");\n        \n        mousePerLine.append(\"circle\")\n                        .attr(\"r\", 2)\n                        .style(\"stroke\", function(d, i) {\n                            return color(names[i]);\n                        })\n                        .style(\"fill\", \"none\")\n                        .style(\"stroke-width\", \"1px\")\n                        .style(\"opacity\", \"0\");\n\n        var chart = tooltipArea\n                            .append(\"svg:rect\")\n                            .attr('width', width)\n                            .attr('height', height)\n                            .attr('fill', 'none')\n                            .attr('pointer-events', 'all')\n                            //.style(\"cursor\", \"pointer\")\n                            .on('mouseout', function() { // on mouse out hide line, circles and text\n                                d3.select(\"#tooltip-line\")\n                                .style(\"opacity\", \"0\");\n                                d3.selectAll(\".mouse-per-line circle\")\n                                .style(\"opacity\", \"0\");\n                                d3.selectAll(\".mouse-per-line text\")\n                                .style(\"opacity\", \"0\")\n                                tooltipBox.style(\"display\", \"none\")\n                            })\n                            .on('mouseover', function() { // on mouse in show line, circles and text\n                                d3.select(\"#tooltip-line\")\n                                .style(\"opacity\", \"1\");\n                                tooltipBox.style(\"display\", \"block\")\n                            })\n                            .on('mousemove', function() { // mouse moving over canvas\n                                var mouse = d3.mouse(this);\n                                var xCoord = mouse[0];\n                                var yCoord = mouse[1];\n                                const xLowerBoundary = x(confirmedData[confirmedData.length - 1].date)\n                                if (xCoord > xLowerBoundary && xCoord < width && yCoord > 0 && yCoord < height) {\n                                    chart.attr(\"cursor\", \"pointer\");\n                                }\n                                else {\n                                    chart.attr(\"cursor\", \"default\");\n                                }\n                                d3\n                                    .select(\"#tooltip-line\")\n                                    .attr(\"d\", function() {\n                                        var d = \"M\" + xCoord + \",\" + height;\n                                        d += \" \" + xCoord + \",\" + 0;\n                                        return d;\n                                    });\n                                tooltipBox\n                                    .style('left', `${d3.event.pageX + 20}px`)\n                                    .style('top', `${d3.event.pageY + 20}px`)\n                                d3\n                                    .selectAll(\".mouse-per-line\")\n                                    .attr(\"transform\", function(d, i) {\n                                        if (d.data.length === 0) {return;}\n                                        var date = x.invert(xCoord);\n                                        var value = -1;\n                                        d.data.map(d => {\n                                            if(+d.date === +d3.timeDay.round(date) && d.defined !== 0) {\n                                                value = d.value;\n                                            }\n                                        })\n                                        var element = d3.select(this);\n                                        var textBox = tooltipBox.select(`.${d.name}`);\n\n                                        if (value >= 0) {\n                                            if(textBox.empty()) {\n                                                textBox = tooltipBox.append(\"div\")\n                                                                     .attr(\"class\", d.name)\n                                                                     .style(\"padding-left\", \"10px\")\n                                                                     .style(\"padding-right\", \"10px\")\n                                                                     .style(\"background-color\", color(names[i]))\n                                                                     .style(\"color\", \"white\");\n\n                                            }\n                                            else {\n                                                textBox.html(`${names[i]}: ${Math.round(value)}`)\n                                            }\n                                            element.select(\"circle\")\n                                                    .style(\"opacity\", \"1\");\n                                            return \"translate(\" + mouse[0] + \",\" + y(value)+\")\";\n                                        }\n                                        else {\n                                            if(!textBox.empty()) {\n                                                textBox.remove();\n                                            }\n\n                                            element\n                                                    .select(\"circle\")\n                                                    .style(\"opacity\", \"0\");\n                                        }\n                                        \n                                });\n                            })\n        ////ADD TODAY LINE/////////////////////////////////////////////////////\n        const today = d3.timeParse(\"%Y-%m-%d\")(new Date().toISOString().substring(0,10));\n        var todayMarker = svg\n                            .append(\"g\")\n                            .attr(\"id\", \"today-marker\")\n        todayMarker\n                    .append(\"line\")\n                    .attr(\"id\", \"today-line\")\n                    .attr(\"x1\", x(today))\n                    .attr(\"x2\", x(today))\n                    .attr(\"y1\", 0)\n                    .attr(\"y2\", height)\n                    .attr(\"stroke\", \"black\")\n                    .attr(\"stroke-width\", 1)\n                    .attr(\"stroke-dasharray\", \"8, 8\")\n        todayMarker\n                    .append(\"text\")\n                    .attr(\"id\", \"today-text\")\n                    .attr(\"transform\", `translate(${x(today) + 17}, 0) rotate(-90)`)\n                    .text(\"Today\")\n                    .style(\"text-anchor\", \"end\")\n\n        /////////////////////////////////////////////////////////////////////////////////////////////\n        // const focusHeight = 100;\n        const focusMargin = 50;\n        var focus = svg\n                            .append(\"g\")\n                                .attr(\"viewBox\", [0, 0, width, focusHeight])\n                                .attr(\"transform\", `translate(0,${height + focusMargin} )`)\n                                //.attr(\"width\", width + 100)\n                                //.attr(\"height\", height)\n                                .style(\"display\", \"block\")\n\n\n\n        /*const xAxis = (g, x, height) => g\n                                            .attr(\"transform\", `translate(0,${height - margin.bottom})`)\n                                            .call(d3.axisBottom(x))*/\n\n        var focusX = d3\n                            .scaleTime()\n                            .domain([confirmedStartDate, predEndDate])\n                            .range([0, width]);\n        const focusY = d3\n                        .scaleLinear()\n                        .domain([0, yAxisMax])\n                        .range([focusHeight - margin.bottom, 0])\n                        .nice();\n        \n        var focusXAxis = focus\n                                    .append(\"g\")\n                                    .attr(\"transform\", `translate(0,${focusHeight - margin.bottom})`)\n                                    .call(d3.axisBottom(focusX));\n        const brush = d3.brushX()\n                        .extent([[0, 0], [width, focusHeight - margin.bottom]])\n                        .on(\"brush\", brushed)\n                        .on(\"end\", brushended);\n\n        const defaultSelection = [x(d3.timeMonth.offset(x.domain()[1], -8)), x.range()[1]];\n    \n        /*context.append(\"g\")\n                .call(xAxis, x, focusHeight);*/\n        const focusLine = d3.line()\n                            .curve(d3.curveCatmullRom)\n                            .x(function(d) {return x(d.date)})\n                            .y(function (d) {return focusY(d.value)})\n        \n        const focusPredLine = d3.line()\n                                .curve(d3.curveBasis)\n                                .defined(d => d.defined)\n                                .x(function(d) { return focusX(d.date) })\n                                .y(function(d) { return focusY(d.value) })        \n        focus.append(\"path\")\n            .datum(confirmedData)\n            .attr(\"d\", focusLine)\n            .attr(\"class\", \"context-curve\")\n            .attr(\"stroke\", color(names[0]))\n        \n        focus.append(\"path\")\n            .datum(aggregateData)\n            .attr(\"d\", focusLine)\n            .attr(\"class\", \"context-curve\")\n            .attr(\"stroke\", color(names[1]))\n\n        var focusPredCurve = focus.append(\"path\")\n                                    .datum(predictionData)\n                                    .attr(\"d\", focusPredLine)\n                                    .attr(\"class\", \"context-curve\")\n                                    .attr(\"stroke\", color(names[2]))\n        \n        forecastData.map((f, index) => {\n            focus\n                    .append(\"path\")\n                    .datum(f)\n                    .attr(\"d\", focusLine)\n                    .attr(\"class\", \"context-curve\")\n                    .attr(\"stroke\", color(models[index]));\n\n        })\n        function brushed() {\n            if (d3.event.selection) {\n                var extent = d3.event.selection;\n                //console.log([ contextX.invert(extent[0]), contextX.invert(extent[1]) ]);\n                x.domain([ focusX.invert(extent[0]), focusX.invert(extent[1]) ]);\n                xAxis\n                        //.transition()\n                        //.duration(1000)\n                        .call(d3.axisBottom(x))\n                var newX = x(confirmedData[confirmedData.length - 1].date);\n                newX = newX < 0 ? 0 : newX;\n                d3\n                    .select(\"#prediction-clip\")\n                    .select(\"rect\")\n                        .attr(\"width\", width - newX)\n                        .attr(\"x\", newX);\n\n                svg\n                    .selectAll(\".line\")\n                    //.transition()\n                    //.duration(1000)\n                    .attr('d', line)\n\n                svg\n                    .select(\"#your-line\")\n                    .attr(\"d\", predLine)\n                \n                //reposition draw your guess text and pointer\n                svg\n                    .select(\"#draw-guess\")\n                    .attr(\"x\", newX + (width - newX) / 2);\n                svg\n                    .select(\"#pointer\")\n                    .selectAll(\"circle\")\n                        .attr(\"cx\", newX);\n                todayMarker.select(\"line\")\n                        .attr(\"x1\", x(today))\n                        .attr(\"x2\", x(today))\n                todayMarker.select(\"text\")\n                        .attr(\"transform\", `translate(${x(today) + 17}, 0) rotate(-90)`)\n\n            }\n        }\n        \n        function brushended() {\n            if (!d3.event.selection) {\n                gb.call(brush.move, defaultSelection);\n                \n            }\n\n        }\n        const gb = focus\n                        .call(brush)\n                        .call(brush.move, defaultSelection)\n                        .on(\"click\", function() {\n                            d3.select(\".speech-bubble\").style(\"display\", \"none\");\n                        })\n        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n        var deleteButton = d3.select(\"#delete-btn\").node()\n        deleteButton.onclick = () => {\n            this.deletePrediction(category)\n            console.log(\"deleted\")\n            predictionData = createDefaultPrediction(predStartDate, predEndDate);\n            predictionData[0].value = confirmedLastVal;\n            predictionData[0].defined = true;\n            //update yourLine\n            var filtered = predictionData.filter(predLine.defined())\n            yourLine.datum(filtered)\n                    .attr('d', predLine)\n            focusPredCurve.datum(filtered)\n                            .attr(\"d\", focusPredLine)\n                    \n            svg\n                .select(\"#drawing-instruction\")\n                .style(\"opacity\", \"1\");\n            compiledData[2].data = predictionData;\n        };\n        var legendConfirmed = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendAggregate = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendPrediction = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 2)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendGeorgiaTech = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 3)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendIhme = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 4)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendYouyang = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 5)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendColumbia = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 6)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        var legendUcla = legend.append(\"rect\")\n                .attr(\"width\", legendCompleteWidth)\n                .attr(\"height\", legendSingleHeight)\n                .attr(\"x\", 0)\n                .attr(\"y\", 10 + legendSingleHeight * 7)\n                .attr(\"fill\", \"none\")\n                .style(\"pointer-events\",\"visible\");\n\n        legendConfirmed.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#confirmed\").style(\"stroke\", color(names[0]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendAggregate.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#aggregate\").style(\"stroke\", color(names[1]));\n                         })\n                         .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendPrediction.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#your-line\").style(\"stroke\", color(names[2]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendGeorgiaTech.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#gt\").style(\"stroke\", color(names[3]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendIhme.on(\"mouseover\", function() {\n                        svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                        svg.select(\"#ihme\").style(\"stroke\", color(names[4]));\n                    })\n                    .on(\"mouseout\", function() {\n                        svg.selectAll(\".line\")\n                            .style(\"stroke\", (d, i) => color(names[i]))\n                    })\n        legendYouyang.on(\"mouseover\", function() {\n                        svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                        svg.select(\"#youyang\").style(\"stroke\", color(names[5]));\n                    })\n                    .on(\"mouseout\", function() {\n                        svg.selectAll(\".line\")\n                            .style(\"stroke\", (d, i) => color(names[i]))\n                    })\n        legendColumbia.on(\"mouseover\", function() {\n                            svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                            svg.select(\"#columbia\").style(\"stroke\", color(names[6]));\n                        })\n                        .on(\"mouseout\", function() {\n                            svg.selectAll(\".line\")\n                                .style(\"stroke\", (d, i) => color(names[i]))\n                        })\n        legendUcla.on(\"mouseover\", function() {\n                        svg.selectAll(\".line\").style(\"stroke\", \"#ddd\");\n                        svg.select(\"#ucla\").style(\"stroke\", color(names[7]));\n                    })\n                    .on(\"mouseout\", function() {\n                        svg.selectAll(\".line\")\n                            .style(\"stroke\", (d, i) => color(names[i]))\n                    })\n    }\n        \n    render() {\n        return(\n        <div>\n            <h2>US Daily Deaths</h2>\n            \n            {/*<p>Current total: {this.confirmedData.value}</p>*/}\n            <div className=\"chart\">\n                <div className=\"first-column\">\n                    <div className=\"main-instruction\">\n                        <p className=\"info\">\n                            <b>COVIDforecasts is created by academic researchers for you to compare \n                            official COVID forecasts and contribute your own. Currently we compare \n                            forecasts for U.S. daily deaths, and we hope to expand to more forecasts \n                            in the future.</b>\n                        </p>\n                        <p>> Hover over the graph to view the tooltip</p>\n                        {/* <br/> */}\n                        <p>> Hover over the legend to view individual curves</p>\n                        {/* <br/> */}\n                        <p>> Drag on the chart to draw your own prediction</p>\n                        {/* <br/> */}\n                        <p>> Click Reset to erase your prediction</p>\n                        {/* <br/> */}\n                        <p>> Navigate to <b>Top Forecasts</b> to view the accuracy of various forecasts and user predictions</p>\n                    </div>\n                </div>\n                <div ref={this.chartRef} className=\"second-column\">\n                    <svg className=\"main-chart\"></svg>\n                    <div className=\"privacy\">\n                        <span className=\"bold\">Privacy</span>: User-contributed forecast data is used to create aggregate forecasts and is displayed to other visitors on the \"Top Forecasts\" page. It may also be used, anonymized, for academic research purposes. Other than that, we do not and will not share or sell any user or visitor information for any reason.\n                    </div>\n                </div>\n                <div className=\"third-column\">\n                    <svg className=\"legend-container\"></svg>\n                    <button className=\"btn btn-primary \" id=\"delete-btn\">Reset</button>\n                    <div class=\"speech-bubble left\">shift or resize the gray box to change the zoom level</div>\n                </div>\n            </div>\n            <div class=\"tooltip-box\"></div>\n        </div>);\n    }\n}\n\nexport default InteractiveChart;","import React, { Component } from 'react';\nimport InteractiveChart from '../../components/InteractiveChart';\nimport { cleanConfirmedData, getLastValue, organizeData } from '../../utils/data';\n\n/*function InteractiveCharts({ dataSet, orgs, userPrediction, confirmed }) {\n    return dataSet.map((data, index) => {\n      return (\n        <InteractiveChart forecast={data} org={orgs[index]} userPrediction={userPrediction} confirmed={confirmed} />\n       );\n    })\n  }*/\n\nclass InteractiveChartContainer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            forecast: null,\n            orgs: null,\n            confirmed: null,\n            confirmedLastVal: null,\n            confirmedLastDate: null,\n            userPrediction: null,\n            aggregate: null,\n            mse: null,\n            user_mse: null,\n            loginStatus: null\n        };\n    }\n\n    componentDidMount() {\n        fetch('/us-inc-deaths-forecasts').then(res => res.json()).then(data => {\n            const [results, orgs] = organizeData(data);\n            this.setState({ forecast: results, orgs });\n        });\n        fetch('/user-prediction?category=us_daily_deaths').then(res => res.json()).then(data => {\n            this.setState({ userPrediction: data });\n            console.log(\"USER PREDICTION\");\n            console.log(data);\n        });\n        fetch('/us-inc-deaths-confirmed-wk-avg').then(res => res.json()).then(data => {\n            this.setState({ confirmed: data });\n        });\n        fetch('/us-inc-deaths-confirmed').then(res => res.json()).then(data => {\n            this.setState({ \n                confirmedLastVal: Object.values(data)[Object.values(data).length - 1],\n                confirmedLastDate: Object.keys(data)[Object.values(data).length - 1]\n             });\n        });\n        fetch('/us-agg-inc-deaths').then(res => res.json()).then(data => {\n            this.setState({ aggregate: data });\n            //console.log(data);\n        });\n        fetch('/us-mse').then(res => res.json()).then(data => {\n            this.setState({ mse: data });\n        });\n        fetch('/user-mse').then(res => res.json()).then(data => {\n            this.setState({ user_mse: data });\n            console.log(\"USER MSE\");\n            console.log(data);\n        });\n        fetch('/login-status/').then(res => res.json()).then(data => {\n            this.setState({ loginStatus: data });\n        });\n    }\n    render() {\n        const { forecast, orgs, userPrediction, confirmed, confirmedLastVal, confirmedLastDate, aggregate, mse, loginStatus } = this.state;\n        if (!forecast || !orgs || !userPrediction || !confirmed || !confirmedLastVal|| !confirmedLastDate || !aggregate || !mse || !loginStatus) return 'Loading...';\n\n        return (\n            <div className=\"chartContainer\">\n                <InteractiveChart\n                    forecast={forecast}\n                    orgs={orgs}\n                    userPrediction={userPrediction}\n                    confirmed={confirmed}\n                    confirmedLastVal={confirmedLastVal}\n                    confirmedLastDate={confirmedLastDate}\n                    aggregate={aggregate}\n                    mse={mse}\n                    loginStatus={loginStatus}\n                    //userStatus={userStatus}\n                />\n            </div>\n        );\n    }\n}\n\nexport default InteractiveChartContainer;","import React from \"react\";\nimport L from \"leaflet\";\nimport statesData from './us-states.json';\nimport countriesData from './countries.json';\n//import './map.css'\n\nconst style = {\n  width: \"100%\",\n  height: \"600px\"\n};\n\nconst mapStyle = (feature) => {\n  return ({\n    weight: 2,\n    opacity: 1,\n    color: \"white\",\n    dashArray: \"3\",\n    fillOpacity: 0.7,\n    fillColor: \"#FFEDA0\"\n\n  });\n}\n\nclass Mapportal extends React.Component {\n  componentDidMount() {\n    // create map\n    this.map = L.map(\"map\", {\n      center: [37.8, -96],\n      zoom: 4,\n      layers: [\n        L.tileLayer(\"https://api.mapbox.com/styles/v1/mapbox/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoicmFjaGVsb21ib2siLCJhIjoiY2tjODZ6c3UzMTh3ZTJyb2JndHN0dXhlOSJ9.h8aubFClamI3kiUsjIgNTg\",\n        {\n          maxZoom: 18,\n          attribution:\n            'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery  <a href=\"http://mapbox.com\">Mapbox</a>',\n          id: \"dark-v10\"\n        })\n      ]\n    });\n\n    this.geojson = L.geoJson(statesData, {\n      style: mapStyle,\n      onEachFeature: this.onEachFeature\n    }).addTo(this.map);\n\n    this.countries = L.geoJson(countriesData, {\n\t\tstyle: mapStyle,\n\t\tonEachFeature: this.onEachFeature\n    }).addTo(this.map);\n    \n    var overlay = {\n\t\t\t\"Countries\": this.countries,\n\t\t\t\"States\" : this.geojson\n\t};\n  L.control.layers(overlay).addTo(this.map);\n\n\n    // add layer\n    this.layer = L.layerGroup().addTo(this.map);\n  }\n  onEachFeature = (feature, layer) => {\n\tlayer.bindTooltip(feature.properties.name.toString(),{noHide:true}).openTooltip();\n    layer.on({\n      mouseover: this.highlightFeature,\n      mouseout: this.resetHighlight\n    });\n    layer.on(\"click\",function(e){\n      // this gets the id for each country, and we can use that to redirect to different pages since each \n      // json layer has different ids. the states are 1-50, and the countries are their official code\n      window.alert(layer.feature.id);\n  });\n  }\n  highlightFeature = (e) => {\n    var layer = e.target;\n\n    layer.setStyle({\n      fillColor: \"#FFEDA0\",\n      weight: 5,\n      color: \"#666\",\n      dashArray: \"\",\n      fillOpacity: 0.7\n    });\n\n    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {\n      layer.bringToFront();\n    }\n    //layer.bringToFront();\n\n  \n  }\n  resetHighlight = (event) => {\n\tthis.geojson.resetStyle(event.target);\n\tthis.countries.resetStyle(event.target);\n  }\n\n  render() {\n    return <div id=\"map\" style={style} />;\n  }\n}\n\nexport default Mapportal;\n","import React from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport ReactDOM from 'react-dom';\nimport './Login.css';\nimport { Redirect } from \"react-router\";\n\n\nclass Login extends React.Component{\n    constructor(props) {\n      super(props)\n      this.state = { username: '', password: '', loggedinstate: '', loginStatus: false }\n    }  \n      \n    componentDidMount(){\n      //this.isLoggedIn();\n    }\n\n    saveLogin(username, password) {\n      return new Promise((resolve, reject) => {\n        fetch('/login/',{\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\"username\": username, \"password\": password}),\n        });\n        resolve();\n      })\n        \n    }\n\n    wasSucess = () => {\n      return new Promise((resolve, reject) => {\n        fetch('/login/',{ method: 'GET'})\n        .then((response) => response.json())\n        .then((data) => {\n          console.log(data);\n          console.log('here2')\n          this.setState({loginStatus: data['status']});\n          resolve(data);\n        });\n      })\n    }\n    \n\n    updateLoginState = () => {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          fetch('/login-status/')\n          .then((response) => response.json())\n          .then((data) => {\n            this.setState({loginStatus: data['logged in']});\n            console.log(data['logged in']);\n            console.log('heretoo')\n            resolve(data['logged in']);\n          });\n        }, 200)\n      })\n\t\t}\n\n    handleChange(event) {\n      let name = event.target.name;\n      if (name === 'username'){\n        this.setState({ username: event.target.value});\n      }\n      if (name === 'password'){\n        this.setState({ password: event.target.value});\n      }\n  \n    }\n    \n    async handleSubmit(event) {\n      console.log(\"submitting\");\n      event.preventDefault();\n      await this.saveLogin(this.state.username, this.state.password);\n      /*await this.wasSucess().then(status => {\n        console.log(status);\n      });*/\n      await this.updateLoginState();\n    }\n\n\n    render() {\n      if (this.state.loginStatus) {\n        //return <Redirect to=\"/\" />\n        window.location.href ='/';\n      }\n      return (\n        <form onSubmit={this.handleSubmit.bind(this)} className='form-group'>\n          <h1>Sign In</h1>\n          <label className='spanStyle'><b>Username</b></label>\n          <br></br>\n          <input\n            type=\"text\"\n            value={this.state.username}\n            onChange={this.handleChange.bind(this)}\n            name='username'\n          />\n          <br></br>\n          <span className='spanStyle'><b>Password</b></span>\n          <br></br>\n          <input\n            type=\"password\"\n            value={this.state.password}\n            onChange={this.handleChange.bind(this)}\n            name='password'\n            required\n          />\n          <br></br>\n            \n          <input type=\"submit\" value=\"Submit\" />\n        </form>\n      );\n    }\n}\n\nexport default Login;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Redirect } from \"react-router\";\nimport '../LogIn/Login.css';\n\nclass SignUp extends React.Component{\n    constructor(props) {\n       super(props)\n      this.state = { nam:'', email: '', username: '', password: '', loginStatus: false }\n    }\n\n    saveLogin(nam, email, username, password) {\n      return new Promise((resolve, reject) => {\n        fetch('/signup/',{\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\"name\": nam, \"email\": email, \"username\": username, \"password\": password}),\n        });\n        resolve();\n      })\n    }\n\n    handleChange(event) {\n      let name = event.target.name;\n      if (name === 'nam'){\n        this.setState({ nam: event.target.value});\n      }\n      if (name === 'email'){\n        this.setState({ email: event.target.value});\n      }\n      if (name === 'username'){\n        this.setState({ username: event.target.value});\n      }\n      if (name === 'password'){\n        this.setState({ password: event.target.value});\n      }\n\n    }\n\n    updateLoginState = () => {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          fetch('/login-status/')\n          .then((response) => response.json())\n          .then((data) => {\n            this.setState({loginStatus: data['logged in']});\n            console.log(data['logged in']);\n            if (!data['logged in']){\n                window.alert(\"That username is already taken.\")\n            }\n            resolve(data['logged in']);\n          });\n        }, 300)\n      })\n    }\n    \n    async handleSubmit(event) {\n      event.preventDefault();\n      await this.saveLogin(this.state.nam, this.state.email, this.state.username, this.state.password);\n      await this.updateLoginState();\n    }\n    \n    render() {\n      if (this.state.loginStatus) {\n        //return <Redirect to=\"/\" />\n        window.location.href ='/';\n      }\n      return (\n        <form onSubmit={this.handleSubmit.bind(this)}>\n          <h1>Sign Up</h1>\n          <span className='signupSpan'><b>Name</b></span>\n          <br></br>\n          <input \n            type=\"text\"\n            value={this.state.nam}\n            onChange={this.handleChange.bind(this)}\n            name='nam'\n            required\n          />\n          <br></br>\n          <span className='signupSpan'><b>Email</b></span>\n          <br></br>\n          <input \n            type=\"text\"\n            value={this.state.email}\n            onChange={this.handleChange.bind(this)}\n            name='email'\n            required\n          />\n          <br></br>\n          <span style={{paddingRight:'280px'}}><b>Username</b></span>\n          <br></br>\n          <input \n            type=\"text\"\n            value={this.state.username}\n            onChange={this.handleChange.bind(this)}\n            name='username'\n            required\n          />\n          <br></br>\n          <span style={{paddingRight:'285px'}}><b>Password</b></span>\n          <br></br>\n          <input \n            type=\"password\"\n            value={this.state.password}\n            onChange={this.handleChange.bind(this)}\n            name='password'\n            required\n          />\n          <br></br>\n          <input type=\"submit\" value=\"Submit\" />\n        </form>\n      );\n    }\n}\n\nexport default SignUp;","import React from 'react';\nimport './App.css';\n//import '/node_modules/bootstrap/dist/css/bootstrap.min.css';\nimport ReactDOM from 'react-dom'\nimport Navbar from './components/Navbar';\nimport ChartContainer from './containers/ChartContainer';\n// import newDeathsContainer from './containers/newDeathsContainer';\nimport LandingPage from './pages/LandingPage';\nimport AboutPage from './pages/AboutPage';\nimport Leaderboard from './components/Leaderboard';\n// import MarketChart from './components/MarketChart';\nimport ProfilePage from './pages/ProfilePage';\nimport InteractiveChartContainer from './containers/InteractiveChartContainer';\nimport UserPredictionChartContainer from './containers/UserPredictionChartContainer';\nimport * as ROUTES from \"./constants/routes\";\nimport 'leaflet/dist/leaflet.css';\nimport Mapportal from './components/Mapportal';\nimport Login from './components/LogIn';\nimport SignUp from './components/SignUp';\nimport {\n  HashRouter as Router,\n  Switch,\n  Route\n} from \"react-router-dom\";\n\n\nclass App extends React.Component {\n  render() {\n    return (\n      <Router basename='/'>\n        <div className=\"App\">\n          <Navbar />\n          <Switch>\n            <Route exact path={ROUTES.LANDING} >\n              {/*<br></br>\n            <div class=\"dropdown\">\n            <button class=\"btn btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n              Country\n            </button>\n            <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton\">\n              <a class=\"dropdown-item\" href=\"/\">USA</a>\n              \n            </div>\n              </div><br></br>*/}\n              <br/>\n              <br/>\n              {/* <p className='pagedesc'><b>COVIDforecasts is created by academic researchers for you to compare official COVID forecasts and contribute your own. Currently we compare forecasts for U.S. daily deaths, and we hope to expand to more forecasts in the future.</b></p>\n              <br></br>  */}\n              <InteractiveChartContainer/>\n              </Route>\n            {/* <Route exact path={ROUTES.US_NATIONAL_CUM} component={ChartContainer} />\n            <Route exact path={ROUTES.US_NATIONAL_INC} component={newDeathsContainer} /> */}\n            <Route exact path={ROUTES.MAP_PORTAL} component={Mapportal} />\n            <Route exact path={ROUTES.LEADERBOARD} component={Leaderboard} />\n            {/* <Route exact path={ROUTES.MARKET} component={MarketChart} /> */}\n            <Route exact path={ROUTES.PROFILE} component={ProfilePage} />\n            <Route exact path={ROUTES.SIGN_IN} component={Login} />\n            <Route exact path={ROUTES.SIGN_UP} component={SignUp} />\n            <Route exact path={ROUTES.ABOUT} component={AboutPage} />\n            <Route exact path=\"/temp\" render={(props) => <ChartContainer isProfile={true}/>}/>\n            \n          </Switch>\n        </div>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {\n  HashRouter as Router\n} from \"react-router-dom\";\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById('root')\n);\n/*\n<React.StrictMode>\n    <App />\n  </React.StrictMode>,\n*/\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/COVIDforecasts-logo-white.e6ddd865.png\";"],"sourceRoot":""}